/* Generated by Cython 0.12.alpha0 on Thu Nov 12 16:38:43 2009 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#else
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
  #define PyDict_CheckExact(op) (Py_TYPE(op) == &PyDict_Type)
  #define PyDict_Contains(d,o)   PySequence_Contains(d,o)
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PY_FORMAT_SIZE_T ""
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)
  #define PyBytes_CheckExact PyString_CheckExact

  typedef struct {
       void *buf;
       PyObject *obj;
       Py_ssize_t len;
       Py_ssize_t itemsize;
       int readonly;
       int ndim;
       char *format;
       Py_ssize_t *shape;
       Py_ssize_t *strides;
       Py_ssize_t *suboffsets;
       void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyString_Type                PyUnicode_Type
  #define PyString_CheckExact          PyUnicode_CheckExact
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
  #define PyBytes_Type                 PyString_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#else
  #define _USE_MATH_DEFINES
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),((char *)(n)))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),((char *)(n)),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),((char *)(n)))
#else
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),(n))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),(n),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),(n))
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_NAMESTR(n) ((char *)(n))
  #define __Pyx_DOCSTR(n)  ((char *)(n))
#else
  #define __Pyx_NAMESTR(n) (n)
  #define __Pyx_DOCSTR(n)  (n)
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#define __PYX_HAVE_API__ctctable
#include "tctdb.h"

#ifdef __GNUC__
#define INLINE __inline__
#elif _WIN32
#define INLINE __inline
#else
#define INLINE 
#endif

typedef struct {PyObject **p; char *s; const long n; const char* encoding; const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry; /*proto*/


/* Type Conversion Predeclarations */

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyBytes_FromString          PyString_FromString
#define __Pyx_PyBytes_FromStringAndSize   PyString_FromStringAndSize
#define __Pyx_PyBytes_AsString            PyString_AsString
#else
#define __Pyx_PyBytes_FromString          PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize   PyBytes_FromStringAndSize
#define __Pyx_PyBytes_AsString            PyBytes_AsString
#endif

#define __Pyx_PyBytes_FromUString(s)      __Pyx_PyBytes_FromString((char*)s)
#define __Pyx_PyBytes_AsUString(s)        ((unsigned char*) __Pyx_PyBytes_AsString(s))

#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);

#if !defined(T_PYSSIZET)
#if PY_VERSION_HEX < 0x02050000
#define T_PYSSIZET T_INT
#elif !defined(T_LONGLONG)
#define T_PYSSIZET \
        ((sizeof(Py_ssize_t) == sizeof(int))  ? T_INT  : \
        ((sizeof(Py_ssize_t) == sizeof(long)) ? T_LONG : -1))
#else
#define T_PYSSIZET \
        ((sizeof(Py_ssize_t) == sizeof(int))          ? T_INT      : \
        ((sizeof(Py_ssize_t) == sizeof(long))         ? T_LONG     : \
        ((sizeof(Py_ssize_t) == sizeof(PY_LONG_LONG)) ? T_LONGLONG : -1)))
#endif
#endif


#if !defined(T_ULONGLONG)
#define __Pyx_T_UNSIGNED_INT(x) \
        ((sizeof(x) == sizeof(unsigned char))  ? T_UBYTE : \
        ((sizeof(x) == sizeof(unsigned short)) ? T_USHORT : \
        ((sizeof(x) == sizeof(unsigned int))   ? T_UINT : \
        ((sizeof(x) == sizeof(unsigned long))  ? T_ULONG : -1))))
#else
#define __Pyx_T_UNSIGNED_INT(x) \
        ((sizeof(x) == sizeof(unsigned char))  ? T_UBYTE : \
        ((sizeof(x) == sizeof(unsigned short)) ? T_USHORT : \
        ((sizeof(x) == sizeof(unsigned int))   ? T_UINT : \
        ((sizeof(x) == sizeof(unsigned long))  ? T_ULONG : \
        ((sizeof(x) == sizeof(unsigned PY_LONG_LONG)) ? T_ULONGLONG : -1)))))
#endif
#if !defined(T_LONGLONG)
#define __Pyx_T_SIGNED_INT(x) \
        ((sizeof(x) == sizeof(char))  ? T_BYTE : \
        ((sizeof(x) == sizeof(short)) ? T_SHORT : \
        ((sizeof(x) == sizeof(int))   ? T_INT : \
        ((sizeof(x) == sizeof(long))  ? T_LONG : -1))))
#else
#define __Pyx_T_SIGNED_INT(x) \
        ((sizeof(x) == sizeof(char))  ? T_BYTE : \
        ((sizeof(x) == sizeof(short)) ? T_SHORT : \
        ((sizeof(x) == sizeof(int))   ? T_INT : \
        ((sizeof(x) == sizeof(long))  ? T_LONG : \
        ((sizeof(x) == sizeof(PY_LONG_LONG))   ? T_LONGLONG : -1)))))
#endif

#define __Pyx_T_FLOATING(x) \
        ((sizeof(x) == sizeof(float)) ? T_FLOAT : \
        ((sizeof(x) == sizeof(double)) ? T_DOUBLE : -1))

#if !defined(T_SIZET)
#if !defined(T_ULONGLONG)
#define T_SIZET \
        ((sizeof(size_t) == sizeof(unsigned int))  ? T_UINT  : \
        ((sizeof(size_t) == sizeof(unsigned long)) ? T_ULONG : -1))
#else
#define T_SIZET \
        ((sizeof(size_t) == sizeof(unsigned int))          ? T_UINT      : \
        ((sizeof(size_t) == sizeof(unsigned long))         ? T_ULONG     : \
        ((sizeof(size_t) == sizeof(unsigned PY_LONG_LONG)) ? T_ULONGLONG : -1)))
#endif
#endif

static INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
static INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);

#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))


#ifdef __GNUC__
/* Test for GCC > 2.95 */
#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
#define likely(x)   __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* __GNUC__ > 2 ... */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;
static const char **__pyx_f;


/* Type declarations */

/* "/usr/local/src/tctable/src/ctctable.pyx":335
 *         return li
 * 
 * cdef class Col(object):             # <<<<<<<<<<<<<<
 *     """
 *     tdb.query(Col('name') == 'Fred' & Col('age') > 22)
 */

struct __pyx_obj_8ctctable_Col {
  PyObject_HEAD
  PyObject *colname;
  int op;
  PyObject *other;
  PyObject *num_lookups;
  int invert;
};

/* "/usr/local/src/tctable/src/ctctable.pyx":26
 *     '''An error communicating with the Tokyo Cabinet database.'''
 * 
 * cdef class TCTable(object):             # <<<<<<<<<<<<<<
 *     '''A Tokyo Cabinet table database.
 * 
 */

struct __pyx_obj_8ctctable_TCTable {
  PyObject_HEAD
  struct __pyx_vtabstruct_8ctctable_TCTable *__pyx_vtab;
  TCTDB *_state;
  PyObject *path;
  PyObject *mode;
  int is_open;
};

/* "/usr/local/src/tctable/src/ctctable.pyx":445
 * # this class just useful as it cleans itself up.
 * # would be nicer to have this for tcmap...
 * cdef class TCQuery(object):             # <<<<<<<<<<<<<<
 *     cdef TDBQRY* _state
 *     def __del__(self):
 */

struct __pyx_obj_8ctctable_TCQuery {
  PyObject_HEAD
  TDBQRY *_state;
};


/* "/usr/local/src/tctable/src/ctctable.pyx":26
 *     '''An error communicating with the Tokyo Cabinet database.'''
 * 
 * cdef class TCTable(object):             # <<<<<<<<<<<<<<
 *     '''A Tokyo Cabinet table database.
 * 
 */

struct __pyx_vtabstruct_8ctctable_TCTable {
  TCMAP *(*_dict_to_tcmap)(struct __pyx_obj_8ctctable_TCTable *, PyObject *);
  PyObject *(*_tcmap_to_dict)(struct __pyx_obj_8ctctable_TCTable *, TCMAP *);
  int (*size_of)(struct __pyx_obj_8ctctable_TCTable *, PyObject *, int __pyx_skip_dispatch);
  void (*_set_limit)(struct __pyx_obj_8ctctable_TCTable *, TDBQRY *, PyObject *);
  void (*_set_order)(struct __pyx_obj_8ctctable_TCTable *, TDBQRY *, PyObject *);
  PyObject *(*_tclist_to_list)(struct __pyx_obj_8ctctable_TCTable *, TCLIST *, int);
};
static struct __pyx_vtabstruct_8ctctable_TCTable *__pyx_vtabptr_8ctctable_TCTable;

#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif

#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct * __Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
  end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
  }
  #define __Pyx_RefNannySetupContext(name)           void *__pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
  #define __Pyx_RefNannyFinishContext()           __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r) __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r) __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r) __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XDECREF(r) do { if((r) != NULL) {__Pyx_DECREF(r);} } while(0)
#else
  #define __Pyx_RefNannySetupContext(name)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
#endif /* CYTHON_REFNANNY */
#define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);} } while(0)
#define __Pyx_XGOTREF(r) do { if((r) != NULL) {__Pyx_GOTREF(r);} } while(0)

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name, PyObject* kw_name); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,     const char* function_name); /*proto*/

static INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static INLINE void __Pyx_RaiseTooManyValuesError(void);

static PyObject *__Pyx_UnpackItem(PyObject *, Py_ssize_t index); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static INLINE long __Pyx_NegateNonNeg(long b) { return unlikely(b < 0) ? b : !b; }
static INLINE PyObject* __Pyx_PyBoolOrNull_FromLong(long b) {
    return unlikely(b < 0) ? NULL : __Pyx_PyBool_FromLong(b);
}

static INLINE void __Pyx_RaiseNoneNotIterableError(void);


static INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}


#define __Pyx_GetItemInt_List(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_List_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
            PyObject *r = PyList_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyList_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyList_GET_ITEM(o, PyList_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
}

#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Tuple_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyTuple_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyTuple_GET_ITEM(o, PyTuple_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
}


#define __Pyx_GetItemInt(o, i, size, to_py_func) ((size <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Fast(o, i, size <= sizeof(long)) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int fits_long) {
    PyObject *r;
    if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (PyTuple_CheckExact(o) && ((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_item && (likely(i >= 0))) {
        r = PySequence_GetItem(o, i);
    }
    else {
        r = __Pyx_GetItemInt_Generic(o, fits_long ? PyInt_FromLong(i) : PyLong_FromLongLong(i));
    }
    return r;
}

static INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict,
    const char* function_name, int kw_allowed); /*proto*/

static INLINE PyObject* __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (PyList_Append(L, x) < 0) return NULL;
        Py_INCREF(Py_None);
        return Py_None; /* this is just to have an accurate signature */
    }
    else {
        PyObject *r, *m;
        m = __Pyx_GetAttrString(L, "append");
        if (!m) return NULL;
        r = PyObject_CallFunctionObjArgs(m, x, NULL);
        Py_DECREF(m);
        return r;
    }
}

static INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb); /*proto*/
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name, const char *modname); /*proto*/

static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject *);

static INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject *);

static INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject *);

static INLINE char __Pyx_PyInt_AsChar(PyObject *);

static INLINE short __Pyx_PyInt_AsShort(PyObject *);

static INLINE int __Pyx_PyInt_AsInt(PyObject *);

static INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject *);

static INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject *);

static INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject *);

static INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject *);

static INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject *);

static INLINE long __Pyx_PyInt_AsLong(PyObject *);

static INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject *);

static INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject *);

static INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject *);

static void __Pyx_WriteUnraisable(const char *name); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static void __Pyx_AddTraceback(const char *funcname); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/
/* Module declarations from python_ref */

/* Module declarations from python_string */

/* Module declarations from ctctable */

static PyTypeObject *__pyx_ptype_8ctctable_TCTable = 0;
static PyTypeObject *__pyx_ptype_8ctctable_Col = 0;
static PyTypeObject *__pyx_ptype_8ctctable_TCQuery = 0;
static struct __pyx_obj_8ctctable_TCQuery *__pyx_f_8ctctable_make_query(TCTDB *); /*proto*/
#define __Pyx_MODULE_NAME "ctctable"
int __pyx_module_is_main_ctctable = 0;

/* Implementation of ctctable */
static PyObject *__pyx_builtin_Exception;
static PyObject *__pyx_builtin_KeyError;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_basestring;
static PyObject *__pyx_builtin_map;
static char __pyx_k_1[] = "%s('%s')";
static char __pyx_k_2[] = "Error.";
static char __pyx_k_3[] = " ";
static char __pyx_k_4[] = "Unable to open {0} for {1}.";
static char __pyx_k_5[] = "Unable to write to database ";
static char __pyx_k_6[] = "Lookup failed: ";
static char __pyx_k_7[] = "Unable to write key \"{0}\".";
static char __pyx_k_8[] = "Could not delete row \"{0}\".";
static char __pyx_k_9[] = "Key not found: \"{0}\"";
static char __pyx_k_10[] = "+";
static char __pyx_k_11[] = "-";
static char __pyx_k_12[] = "This Cython module contains the TCTable class, a driver for\nthe table database in Tokyo Cabinet.\n\nThe TCQuery class represents a query to the table database.\n\nTO DO\n=====\n\n* TCTable.get() should accept a *cols* argument to make it possible for the\nuser to specify the desired columns.\n\n* Implement the missing functions (e.g. tctdbsetindex(), transactions,\nperformance config).\n";
static char __pyx_k_13[] = "tokyo_cabinet_version";
static char __pyx_k_14[] = "0.1";
static char __pyx_k_15[] = "An error communicating with the Tokyo Cabinet database.";
static char __pyx_k__d[] = "d";
static char __pyx_k__k[] = "k";
static char __pyx_k__r[] = "r";
static char __pyx_k__w[] = "w";
static char __pyx_k__id[] = "id";
static char __pyx_k__op[] = "op";
static char __pyx_k__dic[] = "dic";
static char __pyx_k__get[] = "get";
static char __pyx_k__low[] = "low";
static char __pyx_k__map[] = "map";
static char __pyx_k__pop[] = "pop";
static char __pyx_k__put[] = "put";
static char __pyx_k___msg[] = "_msg";
static char __pyx_k__high[] = "high";
static char __pyx_k__join[] = "join";
static char __pyx_k__keep[] = "keep";
static char __pyx_k__mode[] = "mode";
static char __pyx_k__path[] = "path";
static char __pyx_k__count[] = "count";
static char __pyx_k__items[] = "items";
static char __pyx_k__limit[] = "limit";
static char __pyx_k__order[] = "order";
static char __pyx_k__other[] = "other";
static char __pyx_k__range[] = "range";
static char __pyx_k___state[] = "_state";
static char __pyx_k___throw[] = "_throw";
static char __pyx_k__delete[] = "delete";
static char __pyx_k__format[] = "format";
static char __pyx_k__invert[] = "invert";
static char __pyx_k__offset[] = "offset";
static char __pyx_k__select[] = "select";
static char __pyx_k__colname[] = "colname";
static char __pyx_k__default[] = "default";
static char __pyx_k__is_open[] = "is_open";
static char __pyx_k__message[] = "message";
static char __pyx_k__reading[] = "reading";
static char __pyx_k__size_of[] = "size_of";
static char __pyx_k__writing[] = "writing";
static char __pyx_k__KeyError[] = "KeyError";
static char __pyx_k____iter__[] = "__iter__";
static char __pyx_k____main__[] = "__main__";
static char __pyx_k____name__[] = "__name__";
static char __pyx_k__Exception[] = "Exception";
static char __pyx_k____class__[] = "__class__";
static char __pyx_k___set_limit[] = "_set_limit";
static char __pyx_k___set_order[] = "_set_order";
static char __pyx_k__basestring[] = "basestring";
static char __pyx_k__capitalize[] = "capitalize";
static char __pyx_k__TCException[] = "TCException";
static char __pyx_k____version__[] = "__version__";
static char __pyx_k__keep_or_put[] = "keep_or_put";
static char __pyx_k__num_lookups[] = "num_lookups";
static char __pyx_k___key_to_dict[] = "_key_to_dict";
static char __pyx_k___dict_to_tcmap[] = "_dict_to_tcmap";
static char __pyx_k___tcmap_to_dict[] = "_tcmap_to_dict";
static char __pyx_k___tclist_to_list[] = "_tclist_to_list";
static PyObject *__pyx_kp_s_1;
static PyObject *__pyx_kp_s_10;
static PyObject *__pyx_kp_s_11;
static PyObject *__pyx_n_s_13;
static PyObject *__pyx_kp_s_14;
static PyObject *__pyx_kp_s_15;
static PyObject *__pyx_kp_s_2;
static PyObject *__pyx_kp_s_3;
static PyObject *__pyx_kp_s_4;
static PyObject *__pyx_kp_s_5;
static PyObject *__pyx_kp_s_6;
static PyObject *__pyx_kp_s_7;
static PyObject *__pyx_kp_s_8;
static PyObject *__pyx_kp_s_9;
static PyObject *__pyx_n_s__Exception;
static PyObject *__pyx_n_s__KeyError;
static PyObject *__pyx_n_s__TCException;
static PyObject *__pyx_n_s____class__;
static PyObject *__pyx_n_s____iter__;
static PyObject *__pyx_n_s____main__;
static PyObject *__pyx_n_s____name__;
static PyObject *__pyx_n_s____version__;
static PyObject *__pyx_n_s___dict_to_tcmap;
static PyObject *__pyx_n_s___key_to_dict;
static PyObject *__pyx_n_s___msg;
static PyObject *__pyx_n_s___set_limit;
static PyObject *__pyx_n_s___set_order;
static PyObject *__pyx_n_s___state;
static PyObject *__pyx_n_s___tclist_to_list;
static PyObject *__pyx_n_s___tcmap_to_dict;
static PyObject *__pyx_n_s___throw;
static PyObject *__pyx_n_s__basestring;
static PyObject *__pyx_n_s__capitalize;
static PyObject *__pyx_n_s__colname;
static PyObject *__pyx_n_s__count;
static PyObject *__pyx_n_s__d;
static PyObject *__pyx_n_s__default;
static PyObject *__pyx_n_s__delete;
static PyObject *__pyx_n_s__dic;
static PyObject *__pyx_n_s__format;
static PyObject *__pyx_n_s__get;
static PyObject *__pyx_n_s__high;
static PyObject *__pyx_n_s__id;
static PyObject *__pyx_n_s__invert;
static PyObject *__pyx_n_s__is_open;
static PyObject *__pyx_n_s__items;
static PyObject *__pyx_n_s__join;
static PyObject *__pyx_n_s__k;
static PyObject *__pyx_n_s__keep;
static PyObject *__pyx_n_s__keep_or_put;
static PyObject *__pyx_n_s__limit;
static PyObject *__pyx_n_s__low;
static PyObject *__pyx_n_s__map;
static PyObject *__pyx_n_s__message;
static PyObject *__pyx_n_s__mode;
static PyObject *__pyx_n_s__num_lookups;
static PyObject *__pyx_n_s__offset;
static PyObject *__pyx_n_s__op;
static PyObject *__pyx_n_s__order;
static PyObject *__pyx_n_s__other;
static PyObject *__pyx_n_s__path;
static PyObject *__pyx_n_s__pop;
static PyObject *__pyx_n_s__put;
static PyObject *__pyx_n_s__r;
static PyObject *__pyx_n_s__range;
static PyObject *__pyx_n_s__reading;
static PyObject *__pyx_n_s__select;
static PyObject *__pyx_n_s__size_of;
static PyObject *__pyx_n_s__w;
static PyObject *__pyx_n_s__writing;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_5;
static PyObject *__pyx_int_neg_1;

/* "/usr/local/src/tctable/src/ctctable.pyx":49
 *     cdef bint is_open
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         c = self.__class__.__name__
 *         return "%s('%s')" % (c, self.path)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable___repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCTable___repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_c;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_RefNannySetupContext("__repr__");
  __pyx_v_c = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":50
 * 
 *     def __repr__(self):
 *         c = self.__class__.__name__             # <<<<<<<<<<<<<<
 *         return "%s('%s')" % (c, self.path)
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s____class__); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s____name__); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_v_c);
  __pyx_v_c = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":51
 *     def __repr__(self):
 *         c = self.__class__.__name__
 *         return "%s('%s')" % (c, self.path)             # <<<<<<<<<<<<<<
 * 
 *     def _throw(self, message='Error.'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_c);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_c);
  __Pyx_GIVEREF(__pyx_v_c);
  __Pyx_INCREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path);
  PyTuple_SET_ITEM(__pyx_t_2, 1, ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path);
  __Pyx_GIVEREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path);
  __pyx_t_1 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_1), __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("ctctable.TCTable.__repr__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_c);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":53
 *         return "%s('%s')" % (c, self.path)
 * 
 *     def _throw(self, message='Error.'):             # <<<<<<<<<<<<<<
 *         '''Raises a TCException, appending to *message* the last error message
 *         from the table database.
 */

static PyObject *__pyx_pf_8ctctable_7TCTable__throw(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8ctctable_7TCTable__throw[] = "Raises a TCException, appending to *message* the last error message\n        from the table database.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable__throw(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_message = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__message,0};
  __Pyx_RefNannySetupContext("_throw");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_2);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__message);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_throw") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_message = values[0];
  } else {
    __pyx_v_message = ((PyObject *)__pyx_kp_s_2);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_message = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("_throw", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable._throw");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":57
 *         from the table database.
 *         '''
 *         raise TCException(self._msg(message))             # <<<<<<<<<<<<<<
 * 
 *     def _msg(self, message='Error.'):
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__TCException); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___msg); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_message);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_message);
  __Pyx_GIVEREF(__pyx_v_message);
  __pyx_t_4 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_Raise(__pyx_t_4, 0, 0);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("ctctable.TCTable._throw");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":59
 *         raise TCException(self._msg(message))
 * 
 *     def _msg(self, message='Error.'):             # <<<<<<<<<<<<<<
 *         '''Composes an error message for an exception, appending to the value
 *         of *message* the last error message from the table database.
 */

static PyObject *__pyx_pf_8ctctable_7TCTable__msg(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8ctctable_7TCTable__msg[] = "Composes an error message for an exception, appending to the value\n        of *message* the last error message from the table database.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable__msg(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_message = 0;
  int __pyx_v_errorcode;
  PyObject *__pyx_v_msg;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__message,0};
  __Pyx_RefNannySetupContext("_msg");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_2);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__message);
        if (unlikely(value)) { values[0] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "_msg") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_message = values[0];
  } else {
    __pyx_v_message = ((PyObject *)__pyx_kp_s_2);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_message = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("_msg", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable._msg");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_msg = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":63
 *         of *message* the last error message from the table database.
 *         '''
 *         cdef int errorcode = tctdbecode(self._state)             # <<<<<<<<<<<<<<
 *         msg = <char*>tctdberrmsg(errorcode)
 *         return message + ' ' + msg.capitalize()
 */
  __pyx_v_errorcode = tctdbecode(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state);

  /* "/usr/local/src/tctable/src/ctctable.pyx":64
 *         '''
 *         cdef int errorcode = tctdbecode(self._state)
 *         msg = <char*>tctdberrmsg(errorcode)             # <<<<<<<<<<<<<<
 *         return message + ' ' + msg.capitalize()
 * 
 */
  __pyx_t_1 = __Pyx_PyBytes_FromString(((char *)tctdberrmsg(__pyx_v_errorcode))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_v_msg);
  __pyx_v_msg = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":65
 *         cdef int errorcode = tctdbecode(self._state)
 *         msg = <char*>tctdberrmsg(errorcode)
 *         return message + ' ' + msg.capitalize()             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self, path, mode='r'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyNumber_Add(__pyx_v_message, ((PyObject *)__pyx_kp_s_3)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_msg, __pyx_n_s__capitalize); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable._msg");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_msg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":67
 *         return message + ' ' + msg.capitalize()
 * 
 *     def __init__(self, path, mode='r'):             # <<<<<<<<<<<<<<
 *         self.path = path
 *         self.mode = mode
 */

static int __pyx_pf_8ctctable_7TCTable___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8ctctable_7TCTable___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_path = 0;
  PyObject *__pyx_v_mode = 0;
  int __pyx_v_success;
  int __pyx_r;
  char *__pyx_t_1;
  long __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__path,&__pyx_n_s__mode,0};
  __Pyx_RefNannySetupContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_n_s__r);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__path);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__mode);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_path = values[0];
    __pyx_v_mode = values[1];
  } else {
    __pyx_v_mode = ((PyObject *)__pyx_n_s__r);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_mode = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_path = PyTuple_GET_ITEM(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_path);
  __Pyx_INCREF(__pyx_v_mode);

  /* "/usr/local/src/tctable/src/ctctable.pyx":68
 * 
 *     def __init__(self, path, mode='r'):
 *         self.path = path             # <<<<<<<<<<<<<<
 *         self.mode = mode
 *         self._state = tctdbnew()
 */
  __Pyx_INCREF(__pyx_v_path);
  __Pyx_GIVEREF(__pyx_v_path);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path);
  ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->path = __pyx_v_path;

  /* "/usr/local/src/tctable/src/ctctable.pyx":69
 *     def __init__(self, path, mode='r'):
 *         self.path = path
 *         self.mode = mode             # <<<<<<<<<<<<<<
 *         self._state = tctdbnew()
 *         cdef bint success = tctdbopen(self._state, path, 6 if mode=='w' else 1)
 */
  __Pyx_INCREF(__pyx_v_mode);
  __Pyx_GIVEREF(__pyx_v_mode);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->mode);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->mode);
  ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->mode = __pyx_v_mode;

  /* "/usr/local/src/tctable/src/ctctable.pyx":70
 *         self.path = path
 *         self.mode = mode
 *         self._state = tctdbnew()             # <<<<<<<<<<<<<<
 *         cdef bint success = tctdbopen(self._state, path, 6 if mode=='w' else 1)
 *         if not success:
 */
  ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state = tctdbnew();

  /* "/usr/local/src/tctable/src/ctctable.pyx":71
 *         self.mode = mode
 *         self._state = tctdbnew()
 *         cdef bint success = tctdbopen(self._state, path, 6 if mode=='w' else 1)             # <<<<<<<<<<<<<<
 *         if not success:
 *             self._throw('Unable to open {0} for {1}.'.format \
 */
  __pyx_t_1 = __Pyx_PyBytes_AsString(__pyx_v_path); if (unlikely((!__pyx_t_1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = PyObject_RichCompare(__pyx_v_mode, ((PyObject *)__pyx_n_s__w), Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_4) {
    __pyx_t_2 = 6;
  } else {
    __pyx_t_2 = 1;
  }
  __pyx_v_success = tctdbopen(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state, __pyx_t_1, __pyx_t_2);

  /* "/usr/local/src/tctable/src/ctctable.pyx":72
 *         self._state = tctdbnew()
 *         cdef bint success = tctdbopen(self._state, path, 6 if mode=='w' else 1)
 *         if not success:             # <<<<<<<<<<<<<<
 *             self._throw('Unable to open {0} for {1}.'.format \
 *                 (str(path), 'writing' if mode == 'w' else 'reading'))
 */
  __pyx_t_4 = (!__pyx_v_success);
  if (__pyx_t_4) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":73
 *         cdef bint success = tctdbopen(self._state, path, 6 if mode=='w' else 1)
 *         if not success:
 *             self._throw('Unable to open {0} for {1}.'.format \             # <<<<<<<<<<<<<<
 *                 (str(path), 'writing' if mode == 'w' else 'reading'))
 *         self.is_open = True
 */
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___throw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);

    /* "/usr/local/src/tctable/src/ctctable.pyx":74
 *         if not success:
 *             self._throw('Unable to open {0} for {1}.'.format \
 *                 (str(path), 'writing' if mode == 'w' else 'reading'))             # <<<<<<<<<<<<<<
 *         self.is_open = True
 * 
 */
    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_4), __pyx_n_s__format); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_INCREF(__pyx_v_path);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_path);
    __Pyx_GIVEREF(__pyx_v_path);
    __pyx_t_7 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = PyObject_RichCompare(__pyx_v_mode, ((PyObject *)__pyx_n_s__w), Py_EQ); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_4) {
      __Pyx_INCREF(((PyObject *)__pyx_n_s__writing));
      __pyx_t_6 = __pyx_n_s__writing;
    } else {
      __Pyx_INCREF(((PyObject *)__pyx_n_s__reading));
      __pyx_t_6 = __pyx_n_s__reading;
    }
    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_8, 1, ((PyObject *)__pyx_t_6));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_6));
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":75
 *             self._throw('Unable to open {0} for {1}.'.format \
 *                 (str(path), 'writing' if mode == 'w' else 'reading'))
 *         self.is_open = True             # <<<<<<<<<<<<<<
 * 
 *     def close(self):
 */
  ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->is_open = 1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("ctctable.TCTable.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_path);
  __Pyx_DECREF(__pyx_v_mode);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":77
 *         self.is_open = True
 * 
 *     def close(self):             # <<<<<<<<<<<<<<
 *         '''Closes the database file and cleans memory, rendering this
 *         object useless.
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_close(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_close[] = "Closes the database file and cleans memory, rendering this\n        object useless.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable_close(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("close");
  __Pyx_INCREF((PyObject *)__pyx_v_self);

  /* "/usr/local/src/tctable/src/ctctable.pyx":83
 *         #print 'Closing ' + str(self.path)
 *         #cdef bint success = tctdbclose(self._state)
 *         if self.is_open:             # <<<<<<<<<<<<<<
 *             self.is_open = False
 *             tctdbdel(self._state)
 */
  __pyx_t_1 = ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->is_open;
  if (__pyx_t_1) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":84
 *         #cdef bint success = tctdbclose(self._state)
 *         if self.is_open:
 *             self.is_open = False             # <<<<<<<<<<<<<<
 *             tctdbdel(self._state)
 * 
 */
    ((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->is_open = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":85
 *         if self.is_open:
 *             self.is_open = False
 *             tctdbdel(self._state)             # <<<<<<<<<<<<<<
 * 
 *     cdef TCMAP* _dict_to_tcmap(self, dict dic):
 */
    tctdbdel(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state);
    goto __pyx_L5;
  }
  __pyx_L5:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":87
 *             tctdbdel(self._state)
 * 
 *     cdef TCMAP* _dict_to_tcmap(self, dict dic):             # <<<<<<<<<<<<<<
 *         """INTERNAL: take a dict and return the tcmap which must
 *         be deleted with tcmapdel(tcmap)
 */

static  TCMAP *__pyx_f_8ctctable_7TCTable__dict_to_tcmap(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, PyObject *__pyx_v_dic) {
  char *__pyx_v_kbuf;
  char *__pyx_v_vbuf;
  Py_ssize_t __pyx_v_ksiz;
  Py_ssize_t __pyx_v_vsiz;
  TCMAP *__pyx_v_tcmap;
  int __pyx_v_ld;
  PyObject *__pyx_v_key;
  PyObject *__pyx_v_val;
  TCMAP *__pyx_r;
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("_dict_to_tcmap");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_dic);
  __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_val = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":94
 *         cdef Py_ssize_t ksiz, vsiz
 *         cdef TCMAP *tcmap
 *         cdef int ld = len(dic)             # <<<<<<<<<<<<<<
 *         tcmap = tcmapnew2(ld)
 * 
 */
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_dic)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_ld = __pyx_t_1;

  /* "/usr/local/src/tctable/src/ctctable.pyx":95
 *         cdef TCMAP *tcmap
 *         cdef int ld = len(dic)
 *         tcmap = tcmapnew2(ld)             # <<<<<<<<<<<<<<
 * 
 *         for key, val in dic.items():
 */
  __pyx_v_tcmap = tcmapnew2(__pyx_v_ld);

  /* "/usr/local/src/tctable/src/ctctable.pyx":97
 *         tcmap = tcmapnew2(ld)
 * 
 *         for key, val in dic.items():             # <<<<<<<<<<<<<<
 *             ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *             ps.PyString_AsStringAndSize(val, &vbuf, &vsiz)
 */
  __pyx_t_2 = PyDict_Items(((PyObject *)__pyx_v_dic)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = 0; __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++;
    } else {
      __pyx_t_2 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_2) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    if (PyTuple_CheckExact(__pyx_t_2) && likely(PyTuple_GET_SIZE(__pyx_t_2) == 2)) {
      PyObject* tuple = __pyx_t_2;
      __pyx_t_4 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_v_key);
      __pyx_v_key = __pyx_t_4;
      __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_val);
      __pyx_v_val = __pyx_t_5;
      __pyx_t_5 = 0;
    } else {
      __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_4 = __Pyx_UnpackItem(__pyx_t_6, 0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_UnpackItem(__pyx_t_6, 1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      if (__Pyx_EndUnpack(__pyx_t_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_v_key);
      __pyx_v_key = __pyx_t_4;
      __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_val);
      __pyx_v_val = __pyx_t_5;
      __pyx_t_5 = 0;
    }

    /* "/usr/local/src/tctable/src/ctctable.pyx":98
 * 
 *         for key, val in dic.items():
 *             ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *             ps.PyString_AsStringAndSize(val, &vbuf, &vsiz)
 *             tcmapput(tcmap, kbuf, ksiz, vbuf, vsiz)
 */
    __pyx_t_7 = PyString_AsStringAndSize(__pyx_v_key, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "/usr/local/src/tctable/src/ctctable.pyx":99
 *         for key, val in dic.items():
 *             ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *             ps.PyString_AsStringAndSize(val, &vbuf, &vsiz)             # <<<<<<<<<<<<<<
 *             tcmapput(tcmap, kbuf, ksiz, vbuf, vsiz)
 *         return tcmap
 */
    __pyx_t_7 = PyString_AsStringAndSize(__pyx_v_val, (&__pyx_v_vbuf), (&__pyx_v_vsiz)); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "/usr/local/src/tctable/src/ctctable.pyx":100
 *             ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *             ps.PyString_AsStringAndSize(val, &vbuf, &vsiz)
 *             tcmapput(tcmap, kbuf, ksiz, vbuf, vsiz)             # <<<<<<<<<<<<<<
 *         return tcmap
 * 
 */
    tcmapput(__pyx_v_tcmap, __pyx_v_kbuf, __pyx_v_ksiz, __pyx_v_vbuf, __pyx_v_vsiz);
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":101
 *             ps.PyString_AsStringAndSize(val, &vbuf, &vsiz)
 *             tcmapput(tcmap, kbuf, ksiz, vbuf, vsiz)
 *         return tcmap             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_tcmap;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("ctctable.TCTable._dict_to_tcmap");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_key);
  __Pyx_DECREF(__pyx_v_val);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_dic);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":104
 * 
 * 
 *     def __setitem__(self, k, dic):             # <<<<<<<<<<<<<<
 *         '''Takes a key and a value and writes them as a table row.
 *         The key must be a bytes instance.
 */

static int __pyx_pf_8ctctable_7TCTable___setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_k, PyObject *__pyx_v_dic); /*proto*/
static char __pyx_doc_8ctctable_7TCTable___setitem__[] = "Takes a key and a value and writes them as a table row.\n        The key must be a bytes instance.\n        The value must be a dictionary containing bytes.\n        ";
static int __pyx_pf_8ctctable_7TCTable___setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_k, PyObject *__pyx_v_dic) {
  TCMAP *__pyx_v_tcmap;
  char *__pyx_v_kbuf;
  Py_ssize_t __pyx_v_ksiz;
  int __pyx_v_success;
  int __pyx_r;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  __Pyx_RefNannySetupContext("__setitem__");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_k);
  __Pyx_INCREF(__pyx_v_dic);

  /* "/usr/local/src/tctable/src/ctctable.pyx":111
 *         # When you alter this method, you probably modify keep_or_put() too.
 *         # Copy the dictionary to a TCMAP
 *         cdef TCMAP * tcmap = self._dict_to_tcmap(dic)             # <<<<<<<<<<<<<<
 *         cdef char *kbuf
 *         cdef Py_ssize_t ksiz
 */
  if (!(likely(PyDict_CheckExact(__pyx_v_dic))||((__pyx_v_dic) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_v_dic)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_tcmap = ((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_dict_to_tcmap(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), ((PyObject *)__pyx_v_dic));

  /* "/usr/local/src/tctable/src/ctctable.pyx":115
 *         cdef Py_ssize_t ksiz
 *         cdef bint success
 *         ps.PyString_AsStringAndSize(k, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *         success = tctdbput(self._state, kbuf, ksiz, tcmap)
 *         tcmapdel(tcmap)
 */
  __pyx_t_1 = PyString_AsStringAndSize(__pyx_v_k, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":116
 *         cdef bint success
 *         ps.PyString_AsStringAndSize(k, &kbuf, &ksiz)
 *         success = tctdbput(self._state, kbuf, ksiz, tcmap)             # <<<<<<<<<<<<<<
 *         tcmapdel(tcmap)
 * 
 */
  __pyx_v_success = tctdbput(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state, __pyx_v_kbuf, __pyx_v_ksiz, __pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":117
 *         ps.PyString_AsStringAndSize(k, &kbuf, &ksiz)
 *         success = tctdbput(self._state, kbuf, ksiz, tcmap)
 *         tcmapdel(tcmap)             # <<<<<<<<<<<<<<
 * 
 *         if not success:
 */
  tcmapdel(__pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":119
 *         tcmapdel(tcmap)
 * 
 *         if not success:             # <<<<<<<<<<<<<<
 *             self._throw('Unable to write to database '+ str(k))
 * 
 */
  __pyx_t_2 = (!__pyx_v_success);
  if (__pyx_t_2) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":120
 * 
 *         if not success:
 *             self._throw('Unable to write to database '+ str(k))             # <<<<<<<<<<<<<<
 * 
 *     cdef dict _tcmap_to_dict(self, TCMAP *tcmap):
 */
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___throw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_k);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_k);
    __Pyx_GIVEREF(__pyx_v_k);
    __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_kp_s_5), __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("ctctable.TCTable.__setitem__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_k);
  __Pyx_DECREF(__pyx_v_dic);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":122
 *             self._throw('Unable to write to database '+ str(k))
 * 
 *     cdef dict _tcmap_to_dict(self, TCMAP *tcmap):             # <<<<<<<<<<<<<<
 *         cdef dict dic = {}
 *         tcmapiterinit(tcmap) # Initialize the map iterator
 */

static  PyObject *__pyx_f_8ctctable_7TCTable__tcmap_to_dict(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, TCMAP *__pyx_v_tcmap) {
  PyObject *__pyx_v_dic = 0;
  char *__pyx_v_kptr;
  char *__pyx_v_vptr;
  int __pyx_v_ksiz;
  int __pyx_v_vsiz;
  PyObject *__pyx_v_pykey;
  PyObject *__pyx_v_pyval;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  __Pyx_RefNannySetupContext("_tcmap_to_dict");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_v_pykey = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_pyval = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":123
 * 
 *     cdef dict _tcmap_to_dict(self, TCMAP *tcmap):
 *         cdef dict dic = {}             # <<<<<<<<<<<<<<
 *         tcmapiterinit(tcmap) # Initialize the map iterator
 *         cdef char *kptr, *vptr
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_dic = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":124
 *     cdef dict _tcmap_to_dict(self, TCMAP *tcmap):
 *         cdef dict dic = {}
 *         tcmapiterinit(tcmap) # Initialize the map iterator             # <<<<<<<<<<<<<<
 *         cdef char *kptr, *vptr
 *         cdef int ksiz, vsiz
 */
  tcmapiterinit(__pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":127
 *         cdef char *kptr, *vptr
 *         cdef int ksiz, vsiz
 *         while True:             # <<<<<<<<<<<<<<
 *             kptr = <char *>tcmapiternext(tcmap, &ksiz) # Get one column
 *             if kptr == NULL: break
 */
  while (1) {
    __pyx_t_2 = 1;
    if (!__pyx_t_2) break;

    /* "/usr/local/src/tctable/src/ctctable.pyx":128
 *         cdef int ksiz, vsiz
 *         while True:
 *             kptr = <char *>tcmapiternext(tcmap, &ksiz) # Get one column             # <<<<<<<<<<<<<<
 *             if kptr == NULL: break
 * 
 */
    __pyx_v_kptr = ((char *)tcmapiternext(__pyx_v_tcmap, (&__pyx_v_ksiz)));

    /* "/usr/local/src/tctable/src/ctctable.pyx":129
 *         while True:
 *             kptr = <char *>tcmapiternext(tcmap, &ksiz) # Get one column
 *             if kptr == NULL: break             # <<<<<<<<<<<<<<
 * 
 *             vptr = <char *>tcmapget(tcmap, <void *>kptr, ksiz, &vsiz)
 */
    __pyx_t_2 = (__pyx_v_kptr == NULL);
    if (__pyx_t_2) {
      goto __pyx_L4_break;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "/usr/local/src/tctable/src/ctctable.pyx":131
 *             if kptr == NULL: break
 * 
 *             vptr = <char *>tcmapget(tcmap, <void *>kptr, ksiz, &vsiz)             # <<<<<<<<<<<<<<
 * 
 *             pykey = ps.PyString_FromStringAndSize(kptr, <Py_ssize_t>ksiz)
 */
    __pyx_v_vptr = ((char *)tcmapget(__pyx_v_tcmap, ((void *)__pyx_v_kptr), __pyx_v_ksiz, (&__pyx_v_vsiz)));

    /* "/usr/local/src/tctable/src/ctctable.pyx":133
 *             vptr = <char *>tcmapget(tcmap, <void *>kptr, ksiz, &vsiz)
 * 
 *             pykey = ps.PyString_FromStringAndSize(kptr, <Py_ssize_t>ksiz)             # <<<<<<<<<<<<<<
 *             pyval = ps.PyString_FromStringAndSize(vptr, <Py_ssize_t>vsiz)
 *             dic[pykey] = pyval
 */
    __pyx_t_1 = PyString_FromStringAndSize(__pyx_v_kptr, ((Py_ssize_t)__pyx_v_ksiz)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_v_pykey);
    __pyx_v_pykey = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":134
 * 
 *             pykey = ps.PyString_FromStringAndSize(kptr, <Py_ssize_t>ksiz)
 *             pyval = ps.PyString_FromStringAndSize(vptr, <Py_ssize_t>vsiz)             # <<<<<<<<<<<<<<
 *             dic[pykey] = pyval
 * 
 */
    __pyx_t_1 = PyString_FromStringAndSize(__pyx_v_vptr, ((Py_ssize_t)__pyx_v_vsiz)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_v_pyval);
    __pyx_v_pyval = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":135
 *             pykey = ps.PyString_FromStringAndSize(kptr, <Py_ssize_t>ksiz)
 *             pyval = ps.PyString_FromStringAndSize(vptr, <Py_ssize_t>vsiz)
 *             dic[pykey] = pyval             # <<<<<<<<<<<<<<
 * 
 *         return dic
 */
    if (PyDict_SetItem(((PyObject *)__pyx_v_dic), __pyx_v_pykey, __pyx_v_pyval) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L4_break:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":137
 *             dic[pykey] = pyval
 * 
 *         return dic             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(((PyObject *)__pyx_r));
  __Pyx_INCREF(((PyObject *)__pyx_v_dic));
  __pyx_r = __pyx_v_dic;
  goto __pyx_L0;

  __pyx_r = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("ctctable.TCTable._tcmap_to_dict");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dic);
  __Pyx_DECREF(__pyx_v_pykey);
  __Pyx_DECREF(__pyx_v_pyval);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":140
 * 
 * 
 *     def _key_to_dict(self, key):             # <<<<<<<<<<<<<<
 *         """INTERNAL: take the database key and return
 *         the dicitonary associated with that key"""
 */

static PyObject *__pyx_pf_8ctctable_7TCTable__key_to_dict(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static char __pyx_doc_8ctctable_7TCTable__key_to_dict[] = "INTERNAL: take the database key and return\n        the dicitonary associated with that key";
static PyObject *__pyx_pf_8ctctable_7TCTable__key_to_dict(PyObject *__pyx_v_self, PyObject *__pyx_v_key) {
  char *__pyx_v_kbuf;
  Py_ssize_t __pyx_v_ksiz;
  TCMAP *__pyx_v_tcmap;
  PyObject *__pyx_v_dic = 0;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannySetupContext("_key_to_dict");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_key);

  /* "/usr/local/src/tctable/src/ctctable.pyx":145
 *         cdef char *kbuf
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *         cdef TCMAP *tcmap = tctdbget(self._state, kbuf, <int>ksiz)
 *         if tcmap == NULL:
 */
  __pyx_t_1 = PyString_AsStringAndSize(__pyx_v_key, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":146
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *         cdef TCMAP *tcmap = tctdbget(self._state, kbuf, <int>ksiz)             # <<<<<<<<<<<<<<
 *         if tcmap == NULL:
 *             raise KeyError('Lookup failed: ' + str(key))
 */
  __pyx_v_tcmap = tctdbget(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state, __pyx_v_kbuf, ((int)__pyx_v_ksiz));

  /* "/usr/local/src/tctable/src/ctctable.pyx":147
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *         cdef TCMAP *tcmap = tctdbget(self._state, kbuf, <int>ksiz)
 *         if tcmap == NULL:             # <<<<<<<<<<<<<<
 *             raise KeyError('Lookup failed: ' + str(key))
 * 
 */
  __pyx_t_2 = (__pyx_v_tcmap == NULL);
  if (__pyx_t_2) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":148
 *         cdef TCMAP *tcmap = tctdbget(self._state, kbuf, <int>ksiz)
 *         if tcmap == NULL:
 *             raise KeyError('Lookup failed: ' + str(key))             # <<<<<<<<<<<<<<
 * 
 *         cdef dict dic = self._tcmap_to_dict(tcmap)
 */
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_kp_s_6), __pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":150
 *             raise KeyError('Lookup failed: ' + str(key))
 * 
 *         cdef dict dic = self._tcmap_to_dict(tcmap)             # <<<<<<<<<<<<<<
 *         tcmapdel(tcmap)
 *         return dic
 */
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_tcmap_to_dict(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_tcmap)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_dic = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":151
 * 
 *         cdef dict dic = self._tcmap_to_dict(tcmap)
 *         tcmapdel(tcmap)             # <<<<<<<<<<<<<<
 *         return dic
 * 
 */
  tcmapdel(__pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":152
 *         cdef dict dic = self._tcmap_to_dict(tcmap)
 *         tcmapdel(tcmap)
 *         return dic             # <<<<<<<<<<<<<<
 * 
 *     def keep_or_put(self, k, dic):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_dic));
  __pyx_r = ((PyObject *)__pyx_v_dic);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("ctctable.TCTable._key_to_dict");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dic);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_key);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":154
 *         return dic
 * 
 *     def keep_or_put(self, k, dic):             # <<<<<<<<<<<<<<
 *         '''Takes as arguments a key (string) and a value (dict).
 *         If the key already exists in the table, nothing is done
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_keep_or_put(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_keep_or_put[] = "Takes as arguments a key (string) and a value (dict).\n        If the key already exists in the table, nothing is done\n        and the string 'keep' is returned.\n        Otherwise, the value is stored at the key and 'put' is returned.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable_keep_or_put(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_v_dic = 0;
  char *__pyx_v_kbuf;
  Py_ssize_t __pyx_v_ksiz;
  TCMAP *__pyx_v_tcmap;
  int __pyx_v_success;
  int __pyx_v_errorcode;
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,&__pyx_n_s__dic,0};
  __Pyx_RefNannySetupContext("keep_or_put");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__dic);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("keep_or_put", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "keep_or_put") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_k = values[0];
    __pyx_v_dic = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_k = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_dic = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("keep_or_put", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable.keep_or_put");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_k);
  __Pyx_INCREF(__pyx_v_dic);

  /* "/usr/local/src/tctable/src/ctctable.pyx":162
 *         cdef char *kbuf
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(k, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *         cdef TCMAP * tcmap = self._dict_to_tcmap(dic)
 *         cdef bint success = tctdbputkeep(self._state, <void *>kbuf,
 */
  __pyx_t_1 = PyString_AsStringAndSize(__pyx_v_k, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":163
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(k, &kbuf, &ksiz)
 *         cdef TCMAP * tcmap = self._dict_to_tcmap(dic)             # <<<<<<<<<<<<<<
 *         cdef bint success = tctdbputkeep(self._state, <void *>kbuf,
 *                                           <int>ksiz, tcmap)
 */
  if (!(likely(PyDict_CheckExact(__pyx_v_dic))||((__pyx_v_dic) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_v_dic)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_tcmap = ((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_dict_to_tcmap(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), ((PyObject *)__pyx_v_dic));

  /* "/usr/local/src/tctable/src/ctctable.pyx":165
 *         cdef TCMAP * tcmap = self._dict_to_tcmap(dic)
 *         cdef bint success = tctdbputkeep(self._state, <void *>kbuf,
 *                                           <int>ksiz, tcmap)             # <<<<<<<<<<<<<<
 * 
 *         tcmapdel(tcmap)
 */
  __pyx_v_success = tctdbputkeep(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state, ((void *)__pyx_v_kbuf), ((int)__pyx_v_ksiz), __pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":167
 *                                           <int>ksiz, tcmap)
 * 
 *         tcmapdel(tcmap)             # <<<<<<<<<<<<<<
 *         # according to http://1978th.net/tokyocabinet/spex-en.html
 *         cdef int errorcode
 */
  tcmapdel(__pyx_v_tcmap);

  /* "/usr/local/src/tctable/src/ctctable.pyx":170
 *         # according to http://1978th.net/tokyocabinet/spex-en.html
 *         cdef int errorcode
 *         if not success:             # <<<<<<<<<<<<<<
 *             errorcode = tctdbecode(self._state)
 *             if errorcode == 21: # 'existing record'
 */
  __pyx_t_2 = (!__pyx_v_success);
  if (__pyx_t_2) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":171
 *         cdef int errorcode
 *         if not success:
 *             errorcode = tctdbecode(self._state)             # <<<<<<<<<<<<<<
 *             if errorcode == 21: # 'existing record'
 *                 return 'keep'
 */
    __pyx_v_errorcode = tctdbecode(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state);

    /* "/usr/local/src/tctable/src/ctctable.pyx":172
 *         if not success:
 *             errorcode = tctdbecode(self._state)
 *             if errorcode == 21: # 'existing record'             # <<<<<<<<<<<<<<
 *                 return 'keep'
 *             else:
 */
    __pyx_t_2 = (__pyx_v_errorcode == 21);
    if (__pyx_t_2) {

      /* "/usr/local/src/tctable/src/ctctable.pyx":173
 *             errorcode = tctdbecode(self._state)
 *             if errorcode == 21: # 'existing record'
 *                 return 'keep'             # <<<<<<<<<<<<<<
 *             else:
 *                 self._throw('Unable to write key "{0}".'.format(str(k)))
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__keep));
      __pyx_r = ((PyObject *)__pyx_n_s__keep);
      goto __pyx_L0;
      goto __pyx_L7;
    }
    /*else*/ {

      /* "/usr/local/src/tctable/src/ctctable.pyx":175
 *                 return 'keep'
 *             else:
 *                 self._throw('Unable to write key "{0}".'.format(str(k)))             # <<<<<<<<<<<<<<
 *         return 'put'
 * 
 */
      __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___throw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_7), __pyx_n_s__format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_k);
      __Pyx_GIVEREF(__pyx_v_k);
      __pyx_t_6 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_L7:;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":176
 *             else:
 *                 self._throw('Unable to write key "{0}".'.format(str(k)))
 *         return 'put'             # <<<<<<<<<<<<<<
 * 
 *     def setdefault(self, k, dic):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_n_s__put));
  __pyx_r = ((PyObject *)__pyx_n_s__put);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("ctctable.TCTable.keep_or_put");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_k);
  __Pyx_DECREF(__pyx_v_dic);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":178
 *         return 'put'
 * 
 *     def setdefault(self, k, dic):             # <<<<<<<<<<<<<<
 *         '''Writes a record -- d[k] = dic -- if k not in d.
 *         Then returns d[k].
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_setdefault(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_setdefault[] = "Writes a record -- d[k] = dic -- if k not in d.\n        Then returns d[k].\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable_setdefault(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_v_dic = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,&__pyx_n_s__dic,0};
  __Pyx_RefNannySetupContext("setdefault");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__dic);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("setdefault", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "setdefault") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_k = values[0];
    __pyx_v_dic = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_k = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_dic = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setdefault", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable.setdefault");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_k);
  __Pyx_INCREF(__pyx_v_dic);

  /* "/usr/local/src/tctable/src/ctctable.pyx":182
 *         Then returns d[k].
 *         '''
 *         if self.keep_or_put(k, dic) == 'keep':             # <<<<<<<<<<<<<<
 *             return self.get(k, dic)
 *         else:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__keep_or_put); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_k);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_k);
  __Pyx_GIVEREF(__pyx_v_k);
  __Pyx_INCREF(__pyx_v_dic);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_dic);
  __Pyx_GIVEREF(__pyx_v_dic);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_n_s__keep), Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":183
 *         '''
 *         if self.keep_or_put(k, dic) == 'keep':
 *             return self.get(k, dic)             # <<<<<<<<<<<<<<
 *         else:
 *             return dic # which certainly has just been put
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__get); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_k);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_k);
    __Pyx_GIVEREF(__pyx_v_k);
    __Pyx_INCREF(__pyx_v_dic);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_dic);
    __Pyx_GIVEREF(__pyx_v_dic);
    __pyx_t_1 = PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/usr/local/src/tctable/src/ctctable.pyx":185
 *             return self.get(k, dic)
 *         else:
 *             return dic # which certainly has just been put             # <<<<<<<<<<<<<<
 * 
 *     def __getitem__(self, key):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_dic);
    __pyx_r = __pyx_v_dic;
    goto __pyx_L0;
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable.setdefault");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_k);
  __Pyx_DECREF(__pyx_v_dic);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":187
 *             return dic # which certainly has just been put
 * 
 *     def __getitem__(self, key):             # <<<<<<<<<<<<<<
 *         '''Returns a record (as a dict) or raises KeyError.'''
 *         return self._key_to_dict(key)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static char __pyx_doc_8ctctable_7TCTable___getitem__[] = "Returns a record (as a dict) or raises KeyError.";
static PyObject *__pyx_pf_8ctctable_7TCTable___getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_key) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannySetupContext("__getitem__");

  /* "/usr/local/src/tctable/src/ctctable.pyx":189
 *     def __getitem__(self, key):
 *         '''Returns a record (as a dict) or raises KeyError.'''
 *         return self._key_to_dict(key)             # <<<<<<<<<<<<<<
 * 
 *     def get(self, id, default=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___key_to_dict); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_key);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_key);
  __Pyx_GIVEREF(__pyx_v_key);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable.__getitem__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":191
 *         return self._key_to_dict(key)
 * 
 *     def get(self, id, default=None):             # <<<<<<<<<<<<<<
 *         try:
 *             v = self[id]
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_get(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCTable_get(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_id = 0;
  PyObject *__pyx_v_default = 0;
  PyObject *__pyx_v_v;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__id,&__pyx_n_s__default,0};
  __Pyx_RefNannySetupContext("get");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_None);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__id);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__default);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "get") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_id = values[0];
    __pyx_v_default = values[1];
  } else {
    __pyx_v_default = ((PyObject *)Py_None);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_default = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_id = PyTuple_GET_ITEM(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("get", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable.get");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_id);
  __Pyx_INCREF(__pyx_v_default);
  __pyx_v_v = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":192
 * 
 *     def get(self, id, default=None):
 *         try:             # <<<<<<<<<<<<<<
 *             v = self[id]
 *             if not v: return default
 */
  {
    PyObject *__pyx_save_exc_type, *__pyx_save_exc_value, *__pyx_save_exc_tb;
    __Pyx_ExceptionSave(&__pyx_save_exc_type, &__pyx_save_exc_value, &__pyx_save_exc_tb);
    __Pyx_XGOTREF(__pyx_save_exc_type);
    __Pyx_XGOTREF(__pyx_save_exc_value);
    __Pyx_XGOTREF(__pyx_save_exc_tb);
    /*try:*/ {

      /* "/usr/local/src/tctable/src/ctctable.pyx":193
 *     def get(self, id, default=None):
 *         try:
 *             v = self[id]             # <<<<<<<<<<<<<<
 *             if not v: return default
 *             return v
 */
      __pyx_t_1 = PyObject_GetItem(__pyx_v_self, __pyx_v_id); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_v_v);
      __pyx_v_v = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "/usr/local/src/tctable/src/ctctable.pyx":194
 *         try:
 *             v = self[id]
 *             if not v: return default             # <<<<<<<<<<<<<<
 *             return v
 *         except KeyError:
 */
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_v); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
      __pyx_t_3 = (!__pyx_t_2);
      if (__pyx_t_3) {
        __Pyx_XDECREF(__pyx_r);
        __Pyx_INCREF(__pyx_v_default);
        __pyx_r = __pyx_v_default;
        goto __pyx_L10_try_return;
        goto __pyx_L14;
      }
      __pyx_L14:;

      /* "/usr/local/src/tctable/src/ctctable.pyx":195
 *             v = self[id]
 *             if not v: return default
 *             return v             # <<<<<<<<<<<<<<
 *         except KeyError:
 *             return default
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_v);
      __pyx_r = __pyx_v_v;
      goto __pyx_L10_try_return;
    }
    __Pyx_XDECREF(__pyx_save_exc_type); __pyx_save_exc_type = 0;
    __Pyx_XDECREF(__pyx_save_exc_value); __pyx_save_exc_value = 0;
    __Pyx_XDECREF(__pyx_save_exc_tb); __pyx_save_exc_tb = 0;
    goto __pyx_L13_try_end;
    __pyx_L10_try_return:;
    __Pyx_XGIVEREF(__pyx_save_exc_type);
    __Pyx_XGIVEREF(__pyx_save_exc_value);
    __Pyx_XGIVEREF(__pyx_save_exc_tb);
    __Pyx_ExceptionReset(__pyx_save_exc_type, __pyx_save_exc_value, __pyx_save_exc_tb);
    goto __pyx_L0;
    __pyx_L6_error:;
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":196
 *             if not v: return default
 *             return v
 *         except KeyError:             # <<<<<<<<<<<<<<
 *             return default
 * 
 */
    __pyx_t_4 = PyErr_ExceptionMatches(__pyx_builtin_KeyError);
    if (__pyx_t_4) {
      __Pyx_AddTraceback("ctctable.TCTable.get");
      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_5, &__pyx_t_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GOTREF(__pyx_t_6);

      /* "/usr/local/src/tctable/src/ctctable.pyx":197
 *             return v
 *         except KeyError:
 *             return default             # <<<<<<<<<<<<<<
 * 
 *     def __delitem__(self, key):
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_default);
      __pyx_r = __pyx_v_default;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L9_except_return;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L7_exception_handled;
    }
    __pyx_L8_except_error:;
    __Pyx_XGIVEREF(__pyx_save_exc_type);
    __Pyx_XGIVEREF(__pyx_save_exc_value);
    __Pyx_XGIVEREF(__pyx_save_exc_tb);
    __Pyx_ExceptionReset(__pyx_save_exc_type, __pyx_save_exc_value, __pyx_save_exc_tb);
    goto __pyx_L1_error;
    __pyx_L9_except_return:;
    __Pyx_XGIVEREF(__pyx_save_exc_type);
    __Pyx_XGIVEREF(__pyx_save_exc_value);
    __Pyx_XGIVEREF(__pyx_save_exc_tb);
    __Pyx_ExceptionReset(__pyx_save_exc_type, __pyx_save_exc_value, __pyx_save_exc_tb);
    goto __pyx_L0;
    __pyx_L7_exception_handled:;
    __Pyx_XGIVEREF(__pyx_save_exc_type);
    __Pyx_XGIVEREF(__pyx_save_exc_value);
    __Pyx_XGIVEREF(__pyx_save_exc_tb);
    __Pyx_ExceptionReset(__pyx_save_exc_type, __pyx_save_exc_value, __pyx_save_exc_tb);
    __pyx_L13_try_end:;
  }

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("ctctable.TCTable.get");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_v);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_id);
  __Pyx_DECREF(__pyx_v_default);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":199
 *             return default
 * 
 *     def __delitem__(self, key):             # <<<<<<<<<<<<<<
 *         cdef char *kbuf
 *         cdef Py_ssize_t ksiz
 */

static int __pyx_pf_8ctctable_7TCTable___delitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static int __pyx_pf_8ctctable_7TCTable___delitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_key) {
  char *__pyx_v_kbuf;
  Py_ssize_t __pyx_v_ksiz;
  int __pyx_v_success;
  int __pyx_r;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("__delitem__");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_key);

  /* "/usr/local/src/tctable/src/ctctable.pyx":202
 *         cdef char *kbuf
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *         cdef bint success = tctdbout(self._state, kbuf, ksiz)
 *         if not success:
 */
  __pyx_t_1 = PyString_AsStringAndSize(__pyx_v_key, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":203
 *         cdef Py_ssize_t ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *         cdef bint success = tctdbout(self._state, kbuf, ksiz)             # <<<<<<<<<<<<<<
 *         if not success:
 *             raise KeyError(self._msg('Could not delete row "{0}".' \
 */
  __pyx_v_success = tctdbout(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state, __pyx_v_kbuf, __pyx_v_ksiz);

  /* "/usr/local/src/tctable/src/ctctable.pyx":204
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *         cdef bint success = tctdbout(self._state, kbuf, ksiz)
 *         if not success:             # <<<<<<<<<<<<<<
 *             raise KeyError(self._msg('Could not delete row "{0}".' \
 *                                      .format(str(key))))
 */
  __pyx_t_2 = (!__pyx_v_success);
  if (__pyx_t_2) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":205
 *         cdef bint success = tctdbout(self._state, kbuf, ksiz)
 *         if not success:
 *             raise KeyError(self._msg('Could not delete row "{0}".' \             # <<<<<<<<<<<<<<
 *                                      .format(str(key))))
 * 
 */
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___msg); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);

    /* "/usr/local/src/tctable/src/ctctable.pyx":206
 *         if not success:
 *             raise KeyError(self._msg('Could not delete row "{0}".' \
 *                                      .format(str(key))))             # <<<<<<<<<<<<<<
 * 
 *     def pop(self, k, d=None):
 */
    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_8), __pyx_n_s__format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    __pyx_t_6 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_Raise(__pyx_t_6, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("ctctable.TCTable.__delitem__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_key);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":208
 *                                      .format(str(key))))
 * 
 *     def pop(self, k, d=None):             # <<<<<<<<<<<<<<
 *         '''D.pop(k[,d]) -> v, remove specified key and return the
 *         corresponding value. If key is not found, d is returned if given,
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_pop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_pop[] = "D.pop(k[,d]) -> v, remove specified key and return the\n        corresponding value. If key is not found, d is returned if given,\n        otherwise KeyError is raised.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable_pop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_v_d = 0;
  PyObject *__pyx_v_adict;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,&__pyx_n_s__d,0};
  __Pyx_RefNannySetupContext("pop");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_None);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      if (kw_args > 1) {
        PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__d);
        if (unlikely(value)) { values[1] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "pop") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_k = values[0];
    __pyx_v_d = values[1];
  } else {
    __pyx_v_d = ((PyObject *)Py_None);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_d = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: __pyx_v_k = PyTuple_GET_ITEM(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("pop", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.TCTable.pop");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_k);
  __Pyx_INCREF(__pyx_v_d);
  __pyx_v_adict = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":213
 *         otherwise KeyError is raised.
 *         '''
 *         adict = self.get(k)             # <<<<<<<<<<<<<<
 *         if adict is None:
 *             if d is None:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__get); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_k);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_k);
  __Pyx_GIVEREF(__pyx_v_k);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_v_adict);
  __pyx_v_adict = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":214
 *         '''
 *         adict = self.get(k)
 *         if adict is None:             # <<<<<<<<<<<<<<
 *             if d is None:
 *                 raise KeyError('Key not found: "{0}"'.format(k))
 */
  __pyx_t_4 = (__pyx_v_adict == Py_None);
  if (__pyx_t_4) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":215
 *         adict = self.get(k)
 *         if adict is None:
 *             if d is None:             # <<<<<<<<<<<<<<
 *                 raise KeyError('Key not found: "{0}"'.format(k))
 *             else:
 */
    __pyx_t_4 = (__pyx_v_d == Py_None);
    if (__pyx_t_4) {

      /* "/usr/local/src/tctable/src/ctctable.pyx":216
 *         if adict is None:
 *             if d is None:
 *                 raise KeyError('Key not found: "{0}"'.format(k))             # <<<<<<<<<<<<<<
 *             else:
 *                 return d
 */
      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_9), __pyx_n_s__format); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_k);
      __Pyx_GIVEREF(__pyx_v_k);
      __pyx_t_1 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_Call(__pyx_builtin_KeyError, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_t_1, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L7;
    }
    /*else*/ {

      /* "/usr/local/src/tctable/src/ctctable.pyx":218
 *                 raise KeyError('Key not found: "{0}"'.format(k))
 *             else:
 *                 return d             # <<<<<<<<<<<<<<
 *         else:
 *             del self.k
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_d);
      __pyx_r = __pyx_v_d;
      goto __pyx_L0;
    }
    __pyx_L7:;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/usr/local/src/tctable/src/ctctable.pyx":220
 *                 return d
 *         else:
 *             del self.k             # <<<<<<<<<<<<<<
 *             return adict
 * 
 */
    if (PyObject_DelAttr(__pyx_v_self, __pyx_n_s__k) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "/usr/local/src/tctable/src/ctctable.pyx":221
 *         else:
 *             del self.k
 *             return adict             # <<<<<<<<<<<<<<
 * 
 *     cpdef int size_of(self, key):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_adict);
    __pyx_r = __pyx_v_adict;
    goto __pyx_L0;
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable.pop");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_adict);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_k);
  __Pyx_DECREF(__pyx_v_d);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":223
 *             return adict
 * 
 *     cpdef int size_of(self, key):             # <<<<<<<<<<<<<<
 *         '''Returns the size of the value stored at the passed *id*,
 *         or -1 if the id does not exist in the table database.
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_size_of(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static  int __pyx_f_8ctctable_7TCTable_size_of(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, PyObject *__pyx_v_key, int __pyx_skip_dispatch) {
  char *__pyx_v_kbuf;
  Py_ssize_t __pyx_v_ksiz;
  int __pyx_r;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  __Pyx_RefNannySetupContext("size_of");
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overriden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__size_of); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (void *)&__pyx_pf_8ctctable_7TCTable_size_of)) {
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_v_key);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_key);
      __Pyx_GIVEREF(__pyx_v_key);
      __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_4;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "/usr/local/src/tctable/src/ctctable.pyx":232
 *         cdef char *kbuf
 *         cdef Py_ssize_t   ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)             # <<<<<<<<<<<<<<
 *         return tctdbvsiz(self._state, kbuf, <int>ksiz)
 * 
 */
  __pyx_t_4 = PyString_AsStringAndSize(__pyx_v_key, (&__pyx_v_kbuf), (&__pyx_v_ksiz)); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":233
 *         cdef Py_ssize_t   ksiz
 *         ps.PyString_AsStringAndSize(key, &kbuf, &ksiz)
 *         return tctdbvsiz(self._state, kbuf, <int>ksiz)             # <<<<<<<<<<<<<<
 * 
 *     def __contains__(self, key):
 */
  __pyx_r = tctdbvsiz(__pyx_v_self->_state, __pyx_v_kbuf, ((int)__pyx_v_ksiz));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_WriteUnraisable("ctctable.TCTable.size_of");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":223
 *             return adict
 * 
 *     cpdef int size_of(self, key):             # <<<<<<<<<<<<<<
 *         '''Returns the size of the value stored at the passed *id*,
 *         or -1 if the id does not exist in the table database.
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_size_of(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_size_of[] = "Returns the size of the value stored at the passed *id*,\n        or -1 if the id does not exist in the table database.\n        \n        I don't know why this would be useful... the returned number is\n        a little higher than the amount of characters persisted.\n        ";
static PyObject *__pyx_pf_8ctctable_7TCTable_size_of(PyObject *__pyx_v_self, PyObject *__pyx_v_key) {
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("size_of");
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->size_of(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_key, 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("ctctable.TCTable.size_of");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":235
 *         return tctdbvsiz(self._state, kbuf, <int>ksiz)
 * 
 *     def __contains__(self, key):             # <<<<<<<<<<<<<<
 *         '''True if D has a key *key*, else False.
 *         But know that calling D.get(id, defaultdict) is cheaper than
 */

static int __pyx_pf_8ctctable_7TCTable___contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_key); /*proto*/
static char __pyx_doc_8ctctable_7TCTable___contains__[] = "True if D has a key *key*, else False.\n        But know that calling D.get(id, defaultdict) is cheaper than\n            dic = D[id] if id in D else defaultdict\n        ";
static int __pyx_pf_8ctctable_7TCTable___contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_key) {
  int __pyx_r;
  __Pyx_RefNannySetupContext("__contains__");

  /* "/usr/local/src/tctable/src/ctctable.pyx":240
 *             dic = D[id] if id in D else defaultdict
 *         '''
 *         return self.size_of(key) > -1             # <<<<<<<<<<<<<<
 * 
 *     def flush(self):
 */
  __pyx_r = (((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->size_of(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_key, 0) > -1);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":242
 *         return self.size_of(key) > -1
 * 
 *     def flush(self):             # <<<<<<<<<<<<<<
 *         '''Forces changes to be written to disk. Returns a success code.'''
 *         cdef bint success = tctdbsync(self._state)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_flush(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static char __pyx_doc_8ctctable_7TCTable_flush[] = "Forces changes to be written to disk. Returns a success code.";
static PyObject *__pyx_pf_8ctctable_7TCTable_flush(PyObject *__pyx_v_self, PyObject *unused) {
  int __pyx_v_success;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("flush");

  /* "/usr/local/src/tctable/src/ctctable.pyx":244
 *     def flush(self):
 *         '''Forces changes to be written to disk. Returns a success code.'''
 *         cdef bint success = tctdbsync(self._state)             # <<<<<<<<<<<<<<
 *         return success
 * 
 */
  __pyx_v_success = tctdbsync(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state);

  /* "/usr/local/src/tctable/src/ctctable.pyx":245
 *         '''Forces changes to be written to disk. Returns a success code.'''
 *         cdef bint success = tctdbsync(self._state)
 *         return success             # <<<<<<<<<<<<<<
 * 
 *     def __len__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_v_success); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("ctctable.TCTable.flush");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":247
 *         return success
 * 
 *     def __len__(self):             # <<<<<<<<<<<<<<
 *         cdef uint64_t number = tctdbrnum(self._state)
 *         return number
 */

static Py_ssize_t __pyx_pf_8ctctable_7TCTable___len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pf_8ctctable_7TCTable___len__(PyObject *__pyx_v_self) {
  uint64_t __pyx_v_number;
  Py_ssize_t __pyx_r;
  __Pyx_RefNannySetupContext("__len__");

  /* "/usr/local/src/tctable/src/ctctable.pyx":248
 * 
 *     def __len__(self):
 *         cdef uint64_t number = tctdbrnum(self._state)             # <<<<<<<<<<<<<<
 *         return number
 * 
 */
  __pyx_v_number = tctdbrnum(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state);

  /* "/usr/local/src/tctable/src/ctctable.pyx":249
 *     def __len__(self):
 *         cdef uint64_t number = tctdbrnum(self._state)
 *         return number             # <<<<<<<<<<<<<<
 * 
 *     cdef void _set_limit(TCTable self, TDBQRY* query_state, dict kwargs):
 */
  __pyx_r = __pyx_v_number;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":251
 *         return number
 * 
 *     cdef void _set_limit(TCTable self, TDBQRY* query_state, dict kwargs):             # <<<<<<<<<<<<<<
 *         limit = kwargs.pop('limit', None)
 *         offset = kwargs.pop('offset', None)
 */

static  void __pyx_f_8ctctable_7TCTable__set_limit(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, TDBQRY *__pyx_v_query_state, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_limit;
  PyObject *__pyx_v_offset;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("_set_limit");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_kwargs);
  __pyx_v_limit = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_offset = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":252
 * 
 *     cdef void _set_limit(TCTable self, TDBQRY* query_state, dict kwargs):
 *         limit = kwargs.pop('limit', None)             # <<<<<<<<<<<<<<
 *         offset = kwargs.pop('offset', None)
 *         if (limit is None and offset is None): return
 */
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_kwargs), __pyx_n_s__pop); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(((PyObject *)__pyx_n_s__limit));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__limit));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__limit));
  __Pyx_INCREF(Py_None);
  PyTuple_SET_ITEM(__pyx_t_2, 1, Py_None);
  __Pyx_GIVEREF(Py_None);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_v_limit);
  __pyx_v_limit = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":253
 *     cdef void _set_limit(TCTable self, TDBQRY* query_state, dict kwargs):
 *         limit = kwargs.pop('limit', None)
 *         offset = kwargs.pop('offset', None)             # <<<<<<<<<<<<<<
 *         if (limit is None and offset is None): return
 *         if limit is None: limit = -1
 */
  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_kwargs), __pyx_n_s__pop); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(((PyObject *)__pyx_n_s__offset));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__offset));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__offset));
  __Pyx_INCREF(Py_None);
  PyTuple_SET_ITEM(__pyx_t_2, 1, Py_None);
  __Pyx_GIVEREF(Py_None);
  __pyx_t_1 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_v_offset);
  __pyx_v_offset = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":254
 *         limit = kwargs.pop('limit', None)
 *         offset = kwargs.pop('offset', None)
 *         if (limit is None and offset is None): return             # <<<<<<<<<<<<<<
 *         if limit is None: limit = -1
 *         if offset is None: offset = 0
 */
  __pyx_t_4 = (__pyx_v_limit == Py_None);
  if (__pyx_t_4) {
    __pyx_t_5 = (__pyx_v_offset == Py_None);
    __pyx_t_6 = __pyx_t_5;
  } else {
    __pyx_t_6 = __pyx_t_4;
  }
  if (__pyx_t_6) {
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":255
 *         offset = kwargs.pop('offset', None)
 *         if (limit is None and offset is None): return
 *         if limit is None: limit = -1             # <<<<<<<<<<<<<<
 *         if offset is None: offset = 0
 *         tctdbqrysetlimit(query_state, <int>limit, <int>offset)
 */
  __pyx_t_6 = (__pyx_v_limit == Py_None);
  if (__pyx_t_6) {
    __Pyx_INCREF(__pyx_int_neg_1);
    __Pyx_DECREF(__pyx_v_limit);
    __pyx_v_limit = __pyx_int_neg_1;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":256
 *         if (limit is None and offset is None): return
 *         if limit is None: limit = -1
 *         if offset is None: offset = 0             # <<<<<<<<<<<<<<
 *         tctdbqrysetlimit(query_state, <int>limit, <int>offset)
 * 
 */
  __pyx_t_6 = (__pyx_v_offset == Py_None);
  if (__pyx_t_6) {
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_DECREF(__pyx_v_offset);
    __pyx_v_offset = __pyx_int_0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":257
 *         if limit is None: limit = -1
 *         if offset is None: offset = 0
 *         tctdbqrysetlimit(query_state, <int>limit, <int>offset)             # <<<<<<<<<<<<<<
 * 
 *     cdef void _set_order(TCTable self, TDBQRY* query_state, dict kwargs):
 */
  __pyx_t_7 = __Pyx_PyInt_AsInt(__pyx_v_limit); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_offset); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  tctdbqrysetlimit(__pyx_v_query_state, ((int)__pyx_t_7), ((int)__pyx_t_8));

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_WriteUnraisable("ctctable.TCTable._set_limit");
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_limit);
  __Pyx_DECREF(__pyx_v_offset);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
}

/* "/usr/local/src/tctable/src/ctctable.pyx":259
 *         tctdbqrysetlimit(query_state, <int>limit, <int>offset)
 * 
 *     cdef void _set_order(TCTable self, TDBQRY* query_state, dict kwargs):             # <<<<<<<<<<<<<<
 *         if not 'order' in kwargs: return
 *         # TODO: handle nums. NUMASC, NUMDESC how?
 */

static  void __pyx_f_8ctctable_7TCTable__set_order(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, TDBQRY *__pyx_v_query_state, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_col;
  PyObject *__pyx_v_direction;
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  char *__pyx_t_7;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("_set_order");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_kwargs);
  __pyx_v_col = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_direction = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":260
 * 
 *     cdef void _set_order(TCTable self, TDBQRY* query_state, dict kwargs):
 *         if not 'order' in kwargs: return             # <<<<<<<<<<<<<<
 *         # TODO: handle nums. NUMASC, NUMDESC how?
 *         #"order='+name' or order='-name'
 */
  if (unlikely(((PyObject *)__pyx_v_kwargs) == Py_None)) {
    __Pyx_RaiseNoneNotIterableError(); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  } else {
    __pyx_t_1 = ((PyDict_Contains(((PyObject *)__pyx_v_kwargs), ((PyObject *)__pyx_n_s__order)))); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_t_2 = (!__pyx_t_1);
  if (__pyx_t_2) {
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":263
 *         # TODO: handle nums. NUMASC, NUMDESC how?
 *         #"order='+name' or order='-name'
 *         col = kwargs['order']             # <<<<<<<<<<<<<<
 *         if col[0] not in ('+', '-'):
 *             direction = TDBQOSTRASC
 */
  __pyx_t_3 = PyObject_GetItem(((PyObject *)__pyx_v_kwargs), ((PyObject *)__pyx_n_s__order)); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_v_col);
  __pyx_v_col = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":264
 *         #"order='+name' or order='-name'
 *         col = kwargs['order']
 *         if col[0] not in ('+', '-'):             # <<<<<<<<<<<<<<
 *             direction = TDBQOSTRASC
 *         else:
 */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_col, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_kp_s_10), Py_NE); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely((__pyx_t_2 == (int)-1))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = ((int)__pyx_t_2);
  if (__pyx_t_1) {
    __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_kp_s_11), Py_NE); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely((__pyx_t_2 == (int)-1))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = ((int)__pyx_t_2);
    __pyx_t_2 = __pyx_t_5;
  } else {
    __pyx_t_2 = __pyx_t_1;
  }
  __pyx_t_1 = __pyx_t_2;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_1) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":265
 *         col = kwargs['order']
 *         if col[0] not in ('+', '-'):
 *             direction = TDBQOSTRASC             # <<<<<<<<<<<<<<
 *         else:
 *             direction = TDBQOSTRASC if col[0] == '+' else TDBQOSTRDESC
 */
    __pyx_t_3 = PyInt_FromLong(TDBQOSTRASC); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_v_direction);
    __pyx_v_direction = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L4;
  }
  /*else*/ {

    /* "/usr/local/src/tctable/src/ctctable.pyx":267
 *             direction = TDBQOSTRASC
 *         else:
 *             direction = TDBQOSTRASC if col[0] == '+' else TDBQOSTRDESC             # <<<<<<<<<<<<<<
 *             col = col[1:]
 *         tctdbqrysetorder(query_state, col, direction)
 */
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_col, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, ((PyObject *)__pyx_kp_s_10), Py_EQ); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_1) {
      __pyx_t_6 = TDBQOSTRASC;
    } else {
      __pyx_t_6 = TDBQOSTRDESC;
    }
    __pyx_t_4 = PyInt_FromLong(__pyx_t_6); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_v_direction);
    __pyx_v_direction = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":268
 *         else:
 *             direction = TDBQOSTRASC if col[0] == '+' else TDBQOSTRDESC
 *             col = col[1:]             # <<<<<<<<<<<<<<
 *         tctdbqrysetorder(query_state, col, direction)
 * 
 */
    __pyx_t_4 = PySequence_GetSlice(__pyx_v_col, 1, PY_SSIZE_T_MAX); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_v_col);
    __pyx_v_col = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __pyx_L4:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":269
 *             direction = TDBQOSTRASC if col[0] == '+' else TDBQOSTRDESC
 *             col = col[1:]
 *         tctdbqrysetorder(query_state, col, direction)             # <<<<<<<<<<<<<<
 * 
 *     def count(self, *args, **kwargs):
 */
  __pyx_t_7 = __Pyx_PyBytes_AsString(__pyx_v_col); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_8 = __Pyx_PyInt_AsInt(__pyx_v_direction); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  tctdbqrysetorder(__pyx_v_query_state, __pyx_t_7, __pyx_t_8);

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_WriteUnraisable("ctctable.TCTable._set_order");
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_col);
  __Pyx_DECREF(__pyx_v_direction);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
}

/* "/usr/local/src/tctable/src/ctctable.pyx":271
 *         tctdbqrysetorder(query_state, col, direction)
 * 
 *     def count(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         kwargs['count'] = True
 *         return self.select(*args, **kwargs)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_count(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCTable_count(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannySetupContext("count");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "count", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/usr/local/src/tctable/src/ctctable.pyx":272
 * 
 *     def count(self, *args, **kwargs):
 *         kwargs['count'] = True             # <<<<<<<<<<<<<<
 *         return self.select(*args, **kwargs)
 * 
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetItem(__pyx_v_kwargs, ((PyObject *)__pyx_n_s__count), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":273
 *     def count(self, *args, **kwargs):
 *         kwargs['count'] = True
 *         return self.select(*args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     def delete(self, *args, **kwargs):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__select); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __pyx_t_3 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_2), __pyx_v_kwargs); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable.count");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":275
 *         return self.select(*args, **kwargs)
 * 
 *     def delete(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         kwargs['delete'] = True
 *         return self.select(*args, **kwargs)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_delete(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCTable_delete(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannySetupContext("delete");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "delete", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/usr/local/src/tctable/src/ctctable.pyx":276
 * 
 *     def delete(self, *args, **kwargs):
 *         kwargs['delete'] = True             # <<<<<<<<<<<<<<
 *         return self.select(*args, **kwargs)
 * 
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetItem(__pyx_v_kwargs, ((PyObject *)__pyx_n_s__delete), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":277
 *     def delete(self, *args, **kwargs):
 *         kwargs['delete'] = True
 *         return self.select(*args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     def select(self, *args, **kwargs):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__select); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __pyx_t_3 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_2), __pyx_v_kwargs); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.TCTable.delete");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":279
 *         return self.select(*args, **kwargs)
 * 
 *     def select(self, *args, **kwargs):             # <<<<<<<<<<<<<<
 * 
 *         cdef TCQuery q = make_query(self._state)
 */

static PyObject *__pyx_pf_8ctctable_7TCTable_select(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCTable_select(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  struct __pyx_obj_8ctctable_TCQuery *__pyx_v_q = 0;
  TCLIST *__pyx_v_tclist;
  PyObject *__pyx_v_li = 0;
  int __pyx_v_count;
  PyObject *__pyx_v_kwskip;
  PyObject *__pyx_v_colname;
  PyObject *__pyx_v_other;
  PyObject *__pyx_v_col;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  char *__pyx_t_8;
  int __pyx_t_9;
  char *__pyx_t_10;
  __Pyx_RefNannySetupContext("select");
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "select", 1))) return NULL;
  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __Pyx_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_v_kwskip = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_colname = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_other = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_col = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":281
 *     def select(self, *args, **kwargs):
 * 
 *         cdef TCQuery q = make_query(self._state)             # <<<<<<<<<<<<<<
 *         #cdef TDBQRY* query_state = tctdbqrynew(self._state)
 *         cdef TCLIST *tclist
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_8ctctable_make_query(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->_state)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_q = ((struct __pyx_obj_8ctctable_TCQuery *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":284
 *         #cdef TDBQRY* query_state = tctdbqrynew(self._state)
 *         cdef TCLIST *tclist
 *         cdef list li = []             # <<<<<<<<<<<<<<
 *         cdef int count
 *         cdef int i
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_li = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":288
 *         cdef int i
 * 
 *         kwskip = ('delete', 'order', 'count', 'limit', 'offset')             # <<<<<<<<<<<<<<
 * 
 *         # tbl.select(name='fred', age=22)
 */
  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_n_s__delete));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__delete));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__delete));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__order));
  PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_n_s__order));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__order));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__count));
  PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_n_s__count));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__count));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__limit));
  PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_n_s__limit));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__limit));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__offset));
  PyTuple_SET_ITEM(__pyx_t_1, 4, ((PyObject *)__pyx_n_s__offset));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__offset));
  __Pyx_DECREF(__pyx_v_kwskip);
  __pyx_v_kwskip = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":292
 *         # tbl.select(name='fred', age=22)
 *         # convert age=22 to Col('age') == 22
 *         args = list(args)             # <<<<<<<<<<<<<<
 *         for colname, other in kwargs.items():
 *             if colname in kwskip: continue
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_args);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args);
  __Pyx_GIVEREF(__pyx_v_args);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)&PyList_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_v_args);
  __pyx_v_args = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":293
 *         # convert age=22 to Col('age') == 22
 *         args = list(args)
 *         for colname, other in kwargs.items():             # <<<<<<<<<<<<<<
 *             if colname in kwskip: continue
 *             args.append(Col(colname) == other)
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_kwargs, __pyx_n_s__items); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = 0; __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2);
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_2);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    if (PyTuple_CheckExact(__pyx_t_1) && likely(PyTuple_GET_SIZE(__pyx_t_1) == 2)) {
      PyObject* tuple = __pyx_t_1;
      __pyx_t_4 = PyTuple_GET_ITEM(tuple, 0); __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(tuple, 1); __Pyx_INCREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_v_colname);
      __pyx_v_colname = __pyx_t_4;
      __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_other);
      __pyx_v_other = __pyx_t_5;
      __pyx_t_5 = 0;
    } else {
      __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_UnpackItem(__pyx_t_6, 0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_UnpackItem(__pyx_t_6, 1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      if (__Pyx_EndUnpack(__pyx_t_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_v_colname);
      __pyx_v_colname = __pyx_t_4;
      __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_v_other);
      __pyx_v_other = __pyx_t_5;
      __pyx_t_5 = 0;
    }

    /* "/usr/local/src/tctable/src/ctctable.pyx":294
 *         args = list(args)
 *         for colname, other in kwargs.items():
 *             if colname in kwskip: continue             # <<<<<<<<<<<<<<
 *             args.append(Col(colname) == other)
 * 
 */
    __pyx_t_7 = ((PySequence_Contains(__pyx_v_kwskip, __pyx_v_colname))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_7) {
      goto __pyx_L5_continue;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/usr/local/src/tctable/src/ctctable.pyx":295
 *         for colname, other in kwargs.items():
 *             if colname in kwskip: continue
 *             args.append(Col(colname) == other)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_colname);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_colname);
    __Pyx_GIVEREF(__pyx_v_colname);
    __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8ctctable_Col)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_v_other, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyObject_Append(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_L5_continue:;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":299
 * 
 * 
 *         for col in args:             # <<<<<<<<<<<<<<
 *             if col.invert:
 *                 col.op = col.op | TDBQCNEGATE
 */
  if (PyList_CheckExact(__pyx_v_args) || PyTuple_CheckExact(__pyx_v_args)) {
    __pyx_t_3 = 0; __pyx_t_2 = __pyx_v_args; __Pyx_INCREF(__pyx_t_2);
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
  }
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_2))) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++;
    } else {
      __pyx_t_5 = PyIter_Next(__pyx_t_2);
      if (!__pyx_t_5) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_DECREF(__pyx_v_col);
    __pyx_v_col = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":300
 * 
 *         for col in args:
 *             if col.invert:             # <<<<<<<<<<<<<<
 *                 col.op = col.op | TDBQCNEGATE
 *             tctdbqryaddcond(q._state, <char *>col.colname, <int>col.op, <char *>col.other)
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_col, __pyx_n_s__invert); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_7) {

      /* "/usr/local/src/tctable/src/ctctable.pyx":301
 *         for col in args:
 *             if col.invert:
 *                 col.op = col.op | TDBQCNEGATE             # <<<<<<<<<<<<<<
 *             tctdbqryaddcond(q._state, <char *>col.colname, <int>col.op, <char *>col.other)
 * 
 */
      __pyx_t_5 = PyObject_GetAttr(__pyx_v_col, __pyx_n_s__op); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = PyInt_FromLong(TDBQCNEGATE); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = PyNumber_Or(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (PyObject_SetAttr(__pyx_v_col, __pyx_n_s__op, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L10;
    }
    __pyx_L10:;

    /* "/usr/local/src/tctable/src/ctctable.pyx":302
 *             if col.invert:
 *                 col.op = col.op | TDBQCNEGATE
 *             tctdbqryaddcond(q._state, <char *>col.colname, <int>col.op, <char *>col.other)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_col, __pyx_n_s__colname); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = __Pyx_PyBytes_AsString(__pyx_t_4); if (unlikely((!__pyx_t_8) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_col, __pyx_n_s__op); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = __Pyx_PyInt_AsInt(__pyx_t_4); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_col, __pyx_n_s__other); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_10 = __Pyx_PyBytes_AsString(__pyx_t_4); if (unlikely((!__pyx_t_10) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    tctdbqryaddcond(__pyx_v_q->_state, ((char *)__pyx_t_8), ((int)__pyx_t_9), ((char *)__pyx_t_10));
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":306
 * 
 *         # NOTE: this pops limit, offset from kwargs.
 *         self._set_limit(q._state, kwargs)             # <<<<<<<<<<<<<<
 *         self._set_order(q._state, kwargs)
 * 
 */
  if (!(likely(PyDict_CheckExact(__pyx_v_kwargs))||((__pyx_v_kwargs) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_v_kwargs)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_set_limit(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_q->_state, ((PyObject *)__pyx_v_kwargs));

  /* "/usr/local/src/tctable/src/ctctable.pyx":307
 *         # NOTE: this pops limit, offset from kwargs.
 *         self._set_limit(q._state, kwargs)
 *         self._set_order(q._state, kwargs)             # <<<<<<<<<<<<<<
 * 
 *         if 'delete' in kwargs:
 */
  if (!(likely(PyDict_CheckExact(__pyx_v_kwargs))||((__pyx_v_kwargs) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_v_kwargs)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_set_order(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_q->_state, ((PyObject *)__pyx_v_kwargs));

  /* "/usr/local/src/tctable/src/ctctable.pyx":309
 *         self._set_order(q._state, kwargs)
 * 
 *         if 'delete' in kwargs:             # <<<<<<<<<<<<<<
 *             return tctdbqrysearchout(q._state)
 * 
 */
  __pyx_t_7 = ((PySequence_Contains(__pyx_v_kwargs, ((PyObject *)__pyx_n_s__delete)))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_7) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":310
 * 
 *         if 'delete' in kwargs:
 *             return tctdbqrysearchout(q._state)             # <<<<<<<<<<<<<<
 * 
 *         tclist = tctdbqrysearch(q._state)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyBool_FromLong(tctdbqrysearchout(__pyx_v_q->_state)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":312
 *             return tctdbqrysearchout(q._state)
 * 
 *         tclist = tctdbqrysearch(q._state)             # <<<<<<<<<<<<<<
 *         count = tclistnum(tclist) # number of elements in the list
 * 
 */
  __pyx_v_tclist = tctdbqrysearch(__pyx_v_q->_state);

  /* "/usr/local/src/tctable/src/ctctable.pyx":313
 * 
 *         tclist = tctdbqrysearch(q._state)
 *         count = tclistnum(tclist) # number of elements in the list             # <<<<<<<<<<<<<<
 * 
 *         if 'count' in kwargs:
 */
  __pyx_v_count = tclistnum(__pyx_v_tclist);

  /* "/usr/local/src/tctable/src/ctctable.pyx":315
 *         count = tclistnum(tclist) # number of elements in the list
 * 
 *         if 'count' in kwargs:             # <<<<<<<<<<<<<<
 *             tclistdel(tclist)
 *             return count
 */
  __pyx_t_7 = ((PySequence_Contains(__pyx_v_kwargs, ((PyObject *)__pyx_n_s__count)))); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_7) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":316
 * 
 *         if 'count' in kwargs:
 *             tclistdel(tclist)             # <<<<<<<<<<<<<<
 *             return count
 * 
 */
    tclistdel(__pyx_v_tclist);

    /* "/usr/local/src/tctable/src/ctctable.pyx":317
 *         if 'count' in kwargs:
 *             tclistdel(tclist)
 *             return count             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_count); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L12;
  }
  __pyx_L12:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":320
 * 
 * 
 *         li = self._tclist_to_list(tclist, count)             # <<<<<<<<<<<<<<
 *         tclistdel(tclist)
 *         return li
 */
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_8ctctable_TCTable *)((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self)->__pyx_vtab)->_tclist_to_list(((struct __pyx_obj_8ctctable_TCTable *)__pyx_v_self), __pyx_v_tclist, __pyx_v_count)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_v_li));
  __pyx_v_li = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":321
 * 
 *         li = self._tclist_to_list(tclist, count)
 *         tclistdel(tclist)             # <<<<<<<<<<<<<<
 *         return li
 * 
 */
  tclistdel(__pyx_v_tclist);

  /* "/usr/local/src/tctable/src/ctctable.pyx":322
 *         li = self._tclist_to_list(tclist, count)
 *         tclistdel(tclist)
 *         return li             # <<<<<<<<<<<<<<
 * 
 *     cdef list _tclist_to_list(self, TCLIST *tclist, int count):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_li));
  __pyx_r = ((PyObject *)__pyx_v_li);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("ctctable.TCTable.select");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_XDECREF((PyObject *)__pyx_v_q);
  __Pyx_XDECREF(__pyx_v_li);
  __Pyx_DECREF(__pyx_v_kwskip);
  __Pyx_DECREF(__pyx_v_colname);
  __Pyx_DECREF(__pyx_v_other);
  __Pyx_DECREF(__pyx_v_col);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":324
 *         return li
 * 
 *     cdef list _tclist_to_list(self, TCLIST *tclist, int count):             # <<<<<<<<<<<<<<
 *         # INTERNAL: the calling function is still responsible for deleting tclist.
 *         cdef list li = []
 */

static  PyObject *__pyx_f_8ctctable_7TCTable__tclist_to_list(struct __pyx_obj_8ctctable_TCTable *__pyx_v_self, TCLIST *__pyx_v_tclist, int __pyx_v_count) {
  PyObject *__pyx_v_li = 0;
  char *__pyx_v_kbuf;
  int __pyx_v_ksiz;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_key;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("_tclist_to_list");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_v_i = Py_None; __Pyx_INCREF(Py_None);
  __pyx_v_key = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":326
 *     cdef list _tclist_to_list(self, TCLIST *tclist, int count):
 *         # INTERNAL: the calling function is still responsible for deleting tclist.
 *         cdef list li = []             # <<<<<<<<<<<<<<
 *         cdef char *kbuf
 *         cdef int ksiz
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_li = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":329
 *         cdef char *kbuf
 *         cdef int ksiz
 *         for i in range(count):             # <<<<<<<<<<<<<<
 *             kbuf = <char *>tclistval(tclist, i, &ksiz)
 *             key = ps.PyString_FromStringAndSize(kbuf, <Py_ssize_t>ksiz)
 */
  __pyx_t_1 = PyInt_FromLong(__pyx_v_count); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(PyList_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else if (likely(PyTuple_CheckExact(__pyx_t_3))) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++;
    } else {
      __pyx_t_1 = PyIter_Next(__pyx_t_3);
      if (!__pyx_t_1) {
        if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":330
 *         cdef int ksiz
 *         for i in range(count):
 *             kbuf = <char *>tclistval(tclist, i, &ksiz)             # <<<<<<<<<<<<<<
 *             key = ps.PyString_FromStringAndSize(kbuf, <Py_ssize_t>ksiz)
 *             li.append((key, self.get(key)))
 */
    __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_v_i); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_kbuf = ((char *)tclistval(__pyx_v_tclist, __pyx_t_4, (&__pyx_v_ksiz)));

    /* "/usr/local/src/tctable/src/ctctable.pyx":331
 *         for i in range(count):
 *             kbuf = <char *>tclistval(tclist, i, &ksiz)
 *             key = ps.PyString_FromStringAndSize(kbuf, <Py_ssize_t>ksiz)             # <<<<<<<<<<<<<<
 *             li.append((key, self.get(key)))
 *         return li
 */
    __pyx_t_1 = PyString_FromStringAndSize(__pyx_v_kbuf, ((Py_ssize_t)__pyx_v_ksiz)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_v_key);
    __pyx_v_key = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":332
 *             kbuf = <char *>tclistval(tclist, i, &ksiz)
 *             key = ps.PyString_FromStringAndSize(kbuf, <Py_ssize_t>ksiz)
 *             li.append((key, self.get(key)))             # <<<<<<<<<<<<<<
 *         return li
 * 
 */
    if (unlikely(__pyx_v_li == Py_None)) {
      PyErr_SetString(PyExc_AttributeError, "'NoneType' object has no attribute 'append'"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__get); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    __pyx_t_6 = PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_4 = PyList_Append(((PyObject *)__pyx_v_li), __pyx_t_5); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":333
 *             key = ps.PyString_FromStringAndSize(kbuf, <Py_ssize_t>ksiz)
 *             li.append((key, self.get(key)))
 *         return li             # <<<<<<<<<<<<<<
 * 
 * cdef class Col(object):
 */
  __Pyx_XDECREF(((PyObject *)__pyx_r));
  __Pyx_INCREF(((PyObject *)__pyx_v_li));
  __pyx_r = __pyx_v_li;
  goto __pyx_L0;

  __pyx_r = ((PyObject *)Py_None); __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("ctctable.TCTable._tclist_to_list");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_li);
  __Pyx_DECREF(__pyx_v_i);
  __Pyx_DECREF(__pyx_v_key);
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":344
 *     cdef public int op
 *     cdef public object other
 *     cdef public dict num_lookups             # <<<<<<<<<<<<<<
 *     cdef public bint invert
 * 
 */

static PyObject *__pyx_pf_8ctctable_3Col_11num_lookups___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col_11num_lookups___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("__get__");
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups));
  __pyx_r = ((PyObject *)((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_8ctctable_3Col_11num_lookups___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_8ctctable_3Col_11num_lookups___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannySetupContext("__set__");
  if (!(likely(PyDict_CheckExact(__pyx_v_value))||((__pyx_v_value) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected dict, got %.200s", Py_TYPE(__pyx_v_value)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups);
  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups));
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups = ((PyObject *)__pyx_v_value);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("ctctable.Col.num_lookups.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":347
 *     cdef public bint invert
 * 
 *     def __init__(self, colname):             # <<<<<<<<<<<<<<
 *         self.invert = False
 *         self.num_lookups= {
 */

static int __pyx_pf_8ctctable_3Col___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_8ctctable_3Col___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_colname = 0;
  int __pyx_r;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__colname,0};
  __Pyx_RefNannySetupContext("__init__");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[1] = {0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__colname);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_colname = values[0];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_colname = PyTuple_GET_ITEM(__pyx_args, 0);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.Col.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":348
 * 
 *     def __init__(self, colname):
 *         self.invert = False             # <<<<<<<<<<<<<<
 *         self.num_lookups= {
 *                 0: TDBQCNUMLT, # <
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->invert = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":349
 *     def __init__(self, colname):
 *         self.invert = False
 *         self.num_lookups= {             # <<<<<<<<<<<<<<
 *                 0: TDBQCNUMLT, # <
 *                 1: TDBQCNUMLE, # <=
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));

  /* "/usr/local/src/tctable/src/ctctable.pyx":350
 *         self.invert = False
 *         self.num_lookups= {
 *                 0: TDBQCNUMLT, # <             # <<<<<<<<<<<<<<
 *                 1: TDBQCNUMLE, # <=
 *                 2: TDBQCNUMEQ, # ==
 */
  __pyx_t_2 = PyInt_FromLong(TDBQCNUMLT); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_0, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":351
 *         self.num_lookups= {
 *                 0: TDBQCNUMLT, # <
 *                 1: TDBQCNUMLE, # <=             # <<<<<<<<<<<<<<
 *                 2: TDBQCNUMEQ, # ==
 *                 3: TDBQCNUMEQ | TDBQCNEGATE, # !=. # TODO test.
 */
  __pyx_t_2 = PyInt_FromLong(TDBQCNUMLE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_1, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":352
 *                 0: TDBQCNUMLT, # <
 *                 1: TDBQCNUMLE, # <=
 *                 2: TDBQCNUMEQ, # ==             # <<<<<<<<<<<<<<
 *                 3: TDBQCNUMEQ | TDBQCNEGATE, # !=. # TODO test.
 *                 4: TDBQCNUMGT, # >
 */
  __pyx_t_2 = PyInt_FromLong(TDBQCNUMEQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_2, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":353
 *                 1: TDBQCNUMLE, # <=
 *                 2: TDBQCNUMEQ, # ==
 *                 3: TDBQCNUMEQ | TDBQCNEGATE, # !=. # TODO test.             # <<<<<<<<<<<<<<
 *                 4: TDBQCNUMGT, # >
 *                 5: TDBQCNUMGE  # >=
 */
  __pyx_t_2 = PyInt_FromLong((TDBQCNUMEQ | TDBQCNEGATE)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_3, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":354
 *                 2: TDBQCNUMEQ, # ==
 *                 3: TDBQCNUMEQ | TDBQCNEGATE, # !=. # TODO test.
 *                 4: TDBQCNUMGT, # >             # <<<<<<<<<<<<<<
 *                 5: TDBQCNUMGE  # >=
 *             }
 */
  __pyx_t_2 = PyInt_FromLong(TDBQCNUMGT); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_4, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":356
 *                 4: TDBQCNUMGT, # >
 *                 5: TDBQCNUMGE  # >=
 *             }             # <<<<<<<<<<<<<<
 *         self.colname = colname
 *     """
 */
  __pyx_t_2 = PyInt_FromLong(TDBQCNUMGE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_int_5, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":349
 *     def __init__(self, colname):
 *         self.invert = False
 *         self.num_lookups= {             # <<<<<<<<<<<<<<
 *                 0: TDBQCNUMLT, # <
 *                 1: TDBQCNUMLE, # <=
 */
  __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups);
  __Pyx_DECREF(((PyObject *)((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups));
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":357
 *                 5: TDBQCNUMGE  # >=
 *             }
 *         self.colname = colname             # <<<<<<<<<<<<<<
 *     """
 *     void tctdbqryaddcond(TDBQRY *qry, const char *name, int op, const char *expr);
 */
  __Pyx_INCREF(__pyx_v_colname);
  __Pyx_GIVEREF(__pyx_v_colname);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->colname);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->colname);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->colname = __pyx_v_colname;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("ctctable.Col.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":373
 *     # http://docs.cython.org/docs/special_methods.html
 *     # < 0 | <= 1 | == 2 | != 3 |  > 4 | >= 5
 *     def __richcmp__(self, other, op):             # <<<<<<<<<<<<<<
 *         self.other = unicode(other)
 *         if isinstance(other, (int, long, float)):
 */

static PyObject *__pyx_pf_8ctctable_3Col___richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col___richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op) {
  PyObject *__pyx_v_op = 0;
  PyObject *__pyx_v_str_lookups;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  __Pyx_RefNannySetupContext("__richcmp__");
  __pyx_v_op = PyInt_FromLong(__pyx_arg_op); if (unlikely(!__pyx_v_op)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __Pyx_GOTREF(__pyx_v_op);
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.Col.__richcmp__");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF(__pyx_v_self);
  __Pyx_INCREF(__pyx_v_other);
  __pyx_v_str_lookups = Py_None; __Pyx_INCREF(Py_None);

  /* "/usr/local/src/tctable/src/ctctable.pyx":374
 *     # < 0 | <= 1 | == 2 | != 3 |  > 4 | >= 5
 *     def __richcmp__(self, other, op):
 *         self.other = unicode(other)             # <<<<<<<<<<<<<<
 *         if isinstance(other, (int, long, float)):
 *             self.op = self.num_lookups[op]
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_other);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_other);
  __Pyx_GIVEREF(__pyx_v_other);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)&PyUnicode_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyObject_SetAttr(__pyx_v_self, __pyx_n_s__other, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":375
 *     def __richcmp__(self, other, op):
 *         self.other = unicode(other)
 *         if isinstance(other, (int, long, float)):             # <<<<<<<<<<<<<<
 *             self.op = self.num_lookups[op]
 *         else:
 */
  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(((PyObject *)((PyObject*)&PyInt_Type)));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyInt_Type)));
  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyInt_Type)));
  __Pyx_INCREF(((PyObject *)((PyObject*)&PyLong_Type)));
  PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)((PyObject*)&PyLong_Type)));
  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyLong_Type)));
  __Pyx_INCREF(((PyObject *)((PyObject*)&PyFloat_Type)));
  PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)((PyObject*)&PyFloat_Type)));
  __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyFloat_Type)));
  __pyx_t_3 = PyObject_IsInstance(__pyx_v_other, __pyx_t_2); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":376
 *         self.other = unicode(other)
 *         if isinstance(other, (int, long, float)):
 *             self.op = self.num_lookups[op]             # <<<<<<<<<<<<<<
 *         else:
 *             str_lookups= {
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__num_lookups); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyObject_GetItem(__pyx_t_2, __pyx_v_op); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (PyObject_SetAttr(__pyx_v_self, __pyx_n_s__op, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "/usr/local/src/tctable/src/ctctable.pyx":378
 *             self.op = self.num_lookups[op]
 *         else:
 *             str_lookups= {             # <<<<<<<<<<<<<<
 *                 2: TDBQCSTREQ, # ==
 *                 3: TDBQCSTREQ | TDBQCNEGATE # not equal. # TODO test.
 */
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));

    /* "/usr/local/src/tctable/src/ctctable.pyx":379
 *         else:
 *             str_lookups= {
 *                 2: TDBQCSTREQ, # ==             # <<<<<<<<<<<<<<
 *                 3: TDBQCSTREQ | TDBQCNEGATE # not equal. # TODO test.
 *             }
 */
    __pyx_t_2 = PyInt_FromLong(TDBQCSTREQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    if (PyDict_SetItem(__pyx_t_1, __pyx_int_2, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":381
 *                 2: TDBQCSTREQ, # ==
 *                 3: TDBQCSTREQ | TDBQCNEGATE # not equal. # TODO test.
 *             }             # <<<<<<<<<<<<<<
 *             self.op = str_lookups[op]
 *         return self
 */
    __pyx_t_2 = PyInt_FromLong((TDBQCSTREQ | TDBQCNEGATE)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    if (PyDict_SetItem(__pyx_t_1, __pyx_int_3, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_str_lookups);
    __pyx_v_str_lookups = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":382
 *                 3: TDBQCSTREQ | TDBQCNEGATE # not equal. # TODO test.
 *             }
 *             self.op = str_lookups[op]             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
    __pyx_t_1 = PyObject_GetItem(__pyx_v_str_lookups, __pyx_v_op); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyObject_SetAttr(__pyx_v_self, __pyx_n_s__op, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L5:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":383
 *             }
 *             self.op = str_lookups[op]
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def __invert__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("ctctable.Col.__richcmp__");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF(__pyx_v_op);
  __Pyx_DECREF(__pyx_v_str_lookups);
  __Pyx_DECREF(__pyx_v_self);
  __Pyx_DECREF(__pyx_v_other);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":385
 *         return self
 * 
 *     def __invert__(self):             # <<<<<<<<<<<<<<
 *         # ~Col('age') == 180
 *         self.invert = not self.invert
 */

static PyObject *__pyx_pf_8ctctable_3Col___invert__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col___invert__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("__invert__");

  /* "/usr/local/src/tctable/src/ctctable.pyx":387
 *     def __invert__(self):
 *         # ~Col('age') == 180
 *         self.invert = not self.invert             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->invert = (!((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->invert);

  /* "/usr/local/src/tctable/src/ctctable.pyx":388
 *         # ~Col('age') == 180
 *         self.invert = not self.invert
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def matches(self, pattern):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":390
 *         return self
 * 
 *     def matches(self, pattern):             # <<<<<<<<<<<<<<
 *         self.op = TDBQCSTRRX
 *         self.other = pattern
 */

static PyObject *__pyx_pf_8ctctable_3Col_matches(PyObject *__pyx_v_self, PyObject *__pyx_v_pattern); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col_matches(PyObject *__pyx_v_self, PyObject *__pyx_v_pattern) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("matches");

  /* "/usr/local/src/tctable/src/ctctable.pyx":391
 * 
 *     def matches(self, pattern):
 *         self.op = TDBQCSTRRX             # <<<<<<<<<<<<<<
 *         self.other = pattern
 *         return self
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCSTRRX;

  /* "/usr/local/src/tctable/src/ctctable.pyx":392
 *     def matches(self, pattern):
 *         self.op = TDBQCSTRRX
 *         self.other = pattern             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  __Pyx_INCREF(__pyx_v_pattern);
  __Pyx_GIVEREF(__pyx_v_pattern);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_v_pattern;

  /* "/usr/local/src/tctable/src/ctctable.pyx":393
 *         self.op = TDBQCSTRRX
 *         self.other = pattern
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def contains(self, other):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":395
 *         return self
 * 
 *     def contains(self, other):             # <<<<<<<<<<<<<<
 *         """
 *         if other is a list and any is True
 */

static PyObject *__pyx_pf_8ctctable_3Col_contains(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static char __pyx_doc_8ctctable_3Col_contains[] = "\n        if other is a list and any is True\n        it will return all cases where the column is\n        one of those values. if any is False, it will return\n        only columns that match all the values in the list.\n        ";
static PyObject *__pyx_pf_8ctctable_3Col_contains(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  __Pyx_RefNannySetupContext("contains");
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __Pyx_INCREF(__pyx_v_other);

  /* "/usr/local/src/tctable/src/ctctable.pyx":403
 *         """
 * 
 *         if hasattr(other, '__iter__'):             # <<<<<<<<<<<<<<
 *             other = list(other)
 *             if isinstance(other[0], basestring):
 */
  __pyx_t_1 = PyObject_HasAttr(__pyx_v_other, ((PyObject *)__pyx_n_s____iter__)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":404
 * 
 *         if hasattr(other, '__iter__'):
 *             other = list(other)             # <<<<<<<<<<<<<<
 *             if isinstance(other[0], basestring):
 *                 self.op = TDBQCSTROREQ # TDBQCSTRAND
 */
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_other);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_other);
    __Pyx_GIVEREF(__pyx_v_other);
    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyList_Type)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_other);
    __pyx_v_other = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "/usr/local/src/tctable/src/ctctable.pyx":405
 *         if hasattr(other, '__iter__'):
 *             other = list(other)
 *             if isinstance(other[0], basestring):             # <<<<<<<<<<<<<<
 *                 self.op = TDBQCSTROREQ # TDBQCSTRAND
 *                 self.other  = ' '.join(other)
 */
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_other, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = PyObject_IsInstance(__pyx_t_3, __pyx_builtin_basestring); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_1) {

      /* "/usr/local/src/tctable/src/ctctable.pyx":406
 *             other = list(other)
 *             if isinstance(other[0], basestring):
 *                 self.op = TDBQCSTROREQ # TDBQCSTRAND             # <<<<<<<<<<<<<<
 *                 self.other  = ' '.join(other)
 *                 return self
 */
      ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCSTROREQ;

      /* "/usr/local/src/tctable/src/ctctable.pyx":407
 *             if isinstance(other[0], basestring):
 *                 self.op = TDBQCSTROREQ # TDBQCSTRAND
 *                 self.other  = ' '.join(other)             # <<<<<<<<<<<<<<
 *                 return self
 *             else:
 */
      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_3), __pyx_n_s__join); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_v_other);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_other);
      __Pyx_GIVEREF(__pyx_v_other);
      __pyx_t_4 = PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GIVEREF(__pyx_t_4);
      __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
      __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
      ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_t_4;
      __pyx_t_4 = 0;

      /* "/usr/local/src/tctable/src/ctctable.pyx":408
 *                 self.op = TDBQCSTROREQ # TDBQCSTRAND
 *                 self.other  = ' '.join(other)
 *                 return self             # <<<<<<<<<<<<<<
 *             else:
 *                 self.op = TDBQCNUMOREQ
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_self);
      __pyx_r = __pyx_v_self;
      goto __pyx_L0;
      goto __pyx_L6;
    }
    /*else*/ {

      /* "/usr/local/src/tctable/src/ctctable.pyx":410
 *                 return self
 *             else:
 *                 self.op = TDBQCNUMOREQ             # <<<<<<<<<<<<<<
 *                 self.other  = ' '.join(map(str, other))
 * 
 */
      ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCNUMOREQ;

      /* "/usr/local/src/tctable/src/ctctable.pyx":411
 *             else:
 *                 self.op = TDBQCNUMOREQ
 *                 self.other  = ' '.join(map(str, other))             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_kp_s_3), __pyx_n_s__join); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)((PyObject*)&PyString_Type)));
      PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)((PyObject*)&PyString_Type)));
      __Pyx_GIVEREF(((PyObject *)((PyObject*)&PyString_Type)));
      __Pyx_INCREF(__pyx_v_other);
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_other);
      __Pyx_GIVEREF(__pyx_v_other);
      __pyx_t_3 = PyObject_Call(__pyx_builtin_map, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GIVEREF(__pyx_t_3);
      __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
      __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
      ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_t_3;
      __pyx_t_3 = 0;
    }
    __pyx_L6:;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":414
 * 
 * 
 *         if isinstance(other, basestring):             # <<<<<<<<<<<<<<
 *             # so see if the column contains string.
 *             self.op = TDBQCSTRINC
 */
  __pyx_t_1 = PyObject_IsInstance(__pyx_v_other, __pyx_builtin_basestring); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {

    /* "/usr/local/src/tctable/src/ctctable.pyx":416
 *         if isinstance(other, basestring):
 *             # so see if the column contains string.
 *             self.op = TDBQCSTRINC             # <<<<<<<<<<<<<<
 *             self.other = other
 *             return self
 */
    ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCSTRINC;

    /* "/usr/local/src/tctable/src/ctctable.pyx":417
 *             # so see if the column contains string.
 *             self.op = TDBQCSTRINC
 *             self.other = other             # <<<<<<<<<<<<<<
 *             return self
 * 
 */
    __Pyx_INCREF(__pyx_v_other);
    __Pyx_GIVEREF(__pyx_v_other);
    __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
    __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
    ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_v_other;

    /* "/usr/local/src/tctable/src/ctctable.pyx":418
 *             self.op = TDBQCSTRINC
 *             self.other = other
 *             return self             # <<<<<<<<<<<<<<
 * 
 *         # it's a number. so extract columns with this value.
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_self);
    __pyx_r = __pyx_v_self;
    goto __pyx_L0;
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":421
 * 
 *         # it's a number. so extract columns with this value.
 *         self.other = unicode(self.other)             # <<<<<<<<<<<<<<
 *         self.op = self.num_lookups[2] # ==
 *         return self
 */
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  PyTuple_SET_ITEM(__pyx_t_3, 0, ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_GIVEREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)&PyUnicode_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":422
 *         # it's a number. so extract columns with this value.
 *         self.other = unicode(self.other)
 *         self.op = self.num_lookups[2] # ==             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  __pyx_t_2 = __Pyx_GetItemInt(((PyObject *)((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->num_lookups), 2, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = __pyx_t_5;

  /* "/usr/local/src/tctable/src/ctctable.pyx":423
 *         self.other = unicode(self.other)
 *         self.op = self.num_lookups[2] # ==
 *         return self             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("ctctable.Col.contains");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_DECREF((PyObject *)__pyx_v_self);
  __Pyx_DECREF(__pyx_v_other);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":426
 * 
 * 
 *     def startswith(self, other):             # <<<<<<<<<<<<<<
 *         self.other = other
 *         self.op = TDBQCSTRBW
 */

static PyObject *__pyx_pf_8ctctable_3Col_startswith(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col_startswith(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("startswith");

  /* "/usr/local/src/tctable/src/ctctable.pyx":427
 * 
 *     def startswith(self, other):
 *         self.other = other             # <<<<<<<<<<<<<<
 *         self.op = TDBQCSTRBW
 *         return self
 */
  __Pyx_INCREF(__pyx_v_other);
  __Pyx_GIVEREF(__pyx_v_other);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_v_other;

  /* "/usr/local/src/tctable/src/ctctable.pyx":428
 *     def startswith(self, other):
 *         self.other = other
 *         self.op = TDBQCSTRBW             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCSTRBW;

  /* "/usr/local/src/tctable/src/ctctable.pyx":429
 *         self.other = other
 *         self.op = TDBQCSTRBW
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def endswith(self, other):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":431
 *         return self
 * 
 *     def endswith(self, other):             # <<<<<<<<<<<<<<
 *         self.other = other
 *         self.op = TDBQCSTREW
 */

static PyObject *__pyx_pf_8ctctable_3Col_endswith(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col_endswith(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("endswith");

  /* "/usr/local/src/tctable/src/ctctable.pyx":432
 * 
 *     def endswith(self, other):
 *         self.other = other             # <<<<<<<<<<<<<<
 *         self.op = TDBQCSTREW
 *         return self
 */
  __Pyx_INCREF(__pyx_v_other);
  __Pyx_GIVEREF(__pyx_v_other);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_v_other;

  /* "/usr/local/src/tctable/src/ctctable.pyx":433
 *     def endswith(self, other):
 *         self.other = other
 *         self.op = TDBQCSTREW             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCSTREW;

  /* "/usr/local/src/tctable/src/ctctable.pyx":434
 *         self.other = other
 *         self.op = TDBQCSTREW
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def between(self, low, high):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":436
 *         return self
 * 
 *     def between(self, low, high):             # <<<<<<<<<<<<<<
 *         # includes end points.
 *         self.other = str(low) + ' ' + str(high)
 */

static PyObject *__pyx_pf_8ctctable_3Col_between(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_8ctctable_3Col_between(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_low = 0;
  PyObject *__pyx_v_high = 0;
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__low,&__pyx_n_s__high,0};
  __Pyx_RefNannySetupContext("between");
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__low);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__high);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("between", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "between") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_low = values[0];
    __pyx_v_high = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_low = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_high = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("between", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("ctctable.Col.between");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/usr/local/src/tctable/src/ctctable.pyx":438
 *     def between(self, low, high):
 *         # includes end points.
 *         self.other = str(low) + ' ' + str(high)             # <<<<<<<<<<<<<<
 *         self.op = TDBQCNUMBT
 *         return self
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_low);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_low);
  __Pyx_GIVEREF(__pyx_v_low);
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Add(__pyx_t_2, ((PyObject *)__pyx_kp_s_3)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_high);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_high);
  __Pyx_GIVEREF(__pyx_v_high);
  __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  __Pyx_DECREF(((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other);
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->other = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":439
 *         # includes end points.
 *         self.other = str(low) + ' ' + str(high)
 *         self.op = TDBQCNUMBT             # <<<<<<<<<<<<<<
 *         return self
 * 
 */
  ((struct __pyx_obj_8ctctable_Col *)__pyx_v_self)->op = TDBQCNUMBT;

  /* "/usr/local/src/tctable/src/ctctable.pyx":440
 *         self.other = str(low) + ' ' + str(high)
 *         self.op = TDBQCNUMBT
 *         return self             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_r = __pyx_v_self;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("ctctable.Col.between");
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":447
 * cdef class TCQuery(object):
 *     cdef TDBQRY* _state
 *     def __del__(self):             # <<<<<<<<<<<<<<
 *         tctdbqrydel(self._state)
 * cdef TCQuery make_query(TCTDB* tctdb):
 */

static PyObject *__pyx_pf_8ctctable_7TCQuery___del__(PyObject *__pyx_v_self, PyObject *unused); /*proto*/
static PyObject *__pyx_pf_8ctctable_7TCQuery___del__(PyObject *__pyx_v_self, PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannySetupContext("__del__");

  /* "/usr/local/src/tctable/src/ctctable.pyx":448
 *     cdef TDBQRY* _state
 *     def __del__(self):
 *         tctdbqrydel(self._state)             # <<<<<<<<<<<<<<
 * cdef TCQuery make_query(TCTDB* tctdb):
 *     cdef TCQuery query = TCQuery()
 */
  tctdbqrydel(((struct __pyx_obj_8ctctable_TCQuery *)__pyx_v_self)->_state);

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "/usr/local/src/tctable/src/ctctable.pyx":449
 *     def __del__(self):
 *         tctdbqrydel(self._state)
 * cdef TCQuery make_query(TCTDB* tctdb):             # <<<<<<<<<<<<<<
 *     cdef TCQuery query = TCQuery()
 *     query._state = tctdbqrynew(tctdb)
 */

static  struct __pyx_obj_8ctctable_TCQuery *__pyx_f_8ctctable_make_query(TCTDB *__pyx_v_tctdb) {
  struct __pyx_obj_8ctctable_TCQuery *__pyx_v_query = 0;
  struct __pyx_obj_8ctctable_TCQuery *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("make_query");

  /* "/usr/local/src/tctable/src/ctctable.pyx":450
 *         tctdbqrydel(self._state)
 * cdef TCQuery make_query(TCTDB* tctdb):
 *     cdef TCQuery query = TCQuery()             # <<<<<<<<<<<<<<
 *     query._state = tctdbqrynew(tctdb)
 *     return query
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_8ctctable_TCQuery)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_query = ((struct __pyx_obj_8ctctable_TCQuery *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":451
 * cdef TCQuery make_query(TCTDB* tctdb):
 *     cdef TCQuery query = TCQuery()
 *     query._state = tctdbqrynew(tctdb)             # <<<<<<<<<<<<<<
 *     return query
 */
  __pyx_v_query->_state = tctdbqrynew(__pyx_v_tctdb);

  /* "/usr/local/src/tctable/src/ctctable.pyx":452
 *     cdef TCQuery query = TCQuery()
 *     query._state = tctdbqrynew(tctdb)
 *     return query             # <<<<<<<<<<<<<<
 */
  __Pyx_XDECREF(((PyObject *)__pyx_r));
  __Pyx_INCREF(((PyObject *)__pyx_v_query));
  __pyx_r = __pyx_v_query;
  goto __pyx_L0;

  __pyx_r = ((struct __pyx_obj_8ctctable_TCQuery *)Py_None); __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("ctctable.make_query");
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_query);
  __Pyx_XGIVEREF((PyObject *)__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
static struct __pyx_vtabstruct_8ctctable_TCTable __pyx_vtable_8ctctable_TCTable;

static PyObject *__pyx_tp_new_8ctctable_TCTable(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_8ctctable_TCTable *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_8ctctable_TCTable *)o);
  p->__pyx_vtab = __pyx_vtabptr_8ctctable_TCTable;
  p->path = Py_None; Py_INCREF(Py_None);
  p->mode = Py_None; Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_8ctctable_TCTable(PyObject *o) {
  struct __pyx_obj_8ctctable_TCTable *p = (struct __pyx_obj_8ctctable_TCTable *)o;
  Py_XDECREF(p->path);
  Py_XDECREF(p->mode);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_8ctctable_TCTable(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_8ctctable_TCTable *p = (struct __pyx_obj_8ctctable_TCTable *)o;
  if (p->path) {
    e = (*v)(p->path, a); if (e) return e;
  }
  if (p->mode) {
    e = (*v)(p->mode, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_8ctctable_TCTable(PyObject *o) {
  struct __pyx_obj_8ctctable_TCTable *p = (struct __pyx_obj_8ctctable_TCTable *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->path);
  p->path = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->mode);
  p->mode = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__pyx_sq_item_8ctctable_TCTable(PyObject *o, Py_ssize_t i) {
  PyObject *r;
  PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
  r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
  Py_DECREF(x);
  return r;
}

static int __pyx_mp_ass_subscript_8ctctable_TCTable(PyObject *o, PyObject *i, PyObject *v) {
  if (v) {
    return __pyx_pf_8ctctable_7TCTable___setitem__(o, i, v);
  }
  else {
    return __pyx_pf_8ctctable_7TCTable___delitem__(o, i);
  }
}

static struct PyMethodDef __pyx_methods_8ctctable_TCTable[] = {
  {__Pyx_NAMESTR("__repr__"), (PyCFunction)__pyx_pf_8ctctable_7TCTable___repr__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("_throw"), (PyCFunction)__pyx_pf_8ctctable_7TCTable__throw, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable__throw)},
  {__Pyx_NAMESTR("_msg"), (PyCFunction)__pyx_pf_8ctctable_7TCTable__msg, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable__msg)},
  {__Pyx_NAMESTR("close"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_close, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_close)},
  {__Pyx_NAMESTR("_key_to_dict"), (PyCFunction)__pyx_pf_8ctctable_7TCTable__key_to_dict, METH_O, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable__key_to_dict)},
  {__Pyx_NAMESTR("keep_or_put"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_keep_or_put, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_keep_or_put)},
  {__Pyx_NAMESTR("setdefault"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_setdefault, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_setdefault)},
  {__Pyx_NAMESTR("__getitem__"), (PyCFunction)__pyx_pf_8ctctable_7TCTable___getitem__, METH_O|METH_COEXIST, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable___getitem__)},
  {__Pyx_NAMESTR("get"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_get, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("pop"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_pop, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_pop)},
  {__Pyx_NAMESTR("size_of"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_size_of, METH_O, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_size_of)},
  {__Pyx_NAMESTR("flush"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_flush, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_8ctctable_7TCTable_flush)},
  {__Pyx_NAMESTR("count"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_count, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("delete"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_delete, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("select"), (PyCFunction)__pyx_pf_8ctctable_7TCTable_select, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static struct PyMemberDef __pyx_members_8ctctable_TCTable[] = {
  {(char *)"path", T_OBJECT, offsetof(struct __pyx_obj_8ctctable_TCTable, path), READONLY, 0},
  {(char *)"mode", T_OBJECT, offsetof(struct __pyx_obj_8ctctable_TCTable, mode), READONLY, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_TCTable = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_TCTable = {
  __pyx_pf_8ctctable_7TCTable___len__, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  __pyx_sq_item_8ctctable_TCTable, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  __pyx_pf_8ctctable_7TCTable___contains__, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_TCTable = {
  __pyx_pf_8ctctable_7TCTable___len__, /*mp_length*/
  __pyx_pf_8ctctable_7TCTable___getitem__, /*mp_subscript*/
  __pyx_mp_ass_subscript_8ctctable_TCTable, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_TCTable = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8ctctable_TCTable = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("ctctable.TCTable"), /*tp_name*/
  sizeof(struct __pyx_obj_8ctctable_TCTable), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8ctctable_TCTable, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  __pyx_pf_8ctctable_7TCTable___repr__, /*tp_repr*/
  &__pyx_tp_as_number_TCTable, /*tp_as_number*/
  &__pyx_tp_as_sequence_TCTable, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_TCTable, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_TCTable, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  __Pyx_DOCSTR("A Tokyo Cabinet table database.\n    \n    The TCTable constructor takes these parameters:\n    \n    *path* is the path to the database file to be opened. Its extension\n    is normally .tct.\n    \n    *mode* is either 'w' for write or 'r' for read.\n    \n    The object is used exactly as a Python dictionary; however,\n    all its values are dicts containing column:value pairs, where both\n    *column* and *value* must be instances of *bytes*.\n    \n    TODO: TCTable is not iterable; currently you have to tctable.query.all()\n    \n    TODO: Add transactions, vanish, tctdbcopy (backup).\n    "), /*tp_doc*/
  __pyx_tp_traverse_8ctctable_TCTable, /*tp_traverse*/
  __pyx_tp_clear_8ctctable_TCTable, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8ctctable_TCTable, /*tp_methods*/
  __pyx_members_8ctctable_TCTable, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8ctctable_7TCTable___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8ctctable_TCTable, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_8ctctable_Col(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_8ctctable_Col *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_8ctctable_Col *)o);
  p->colname = Py_None; Py_INCREF(Py_None);
  p->other = Py_None; Py_INCREF(Py_None);
  p->num_lookups = ((PyObject *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_8ctctable_Col(PyObject *o) {
  struct __pyx_obj_8ctctable_Col *p = (struct __pyx_obj_8ctctable_Col *)o;
  Py_XDECREF(p->colname);
  Py_XDECREF(p->other);
  Py_XDECREF(((PyObject *)p->num_lookups));
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_8ctctable_Col(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_8ctctable_Col *p = (struct __pyx_obj_8ctctable_Col *)o;
  if (p->colname) {
    e = (*v)(p->colname, a); if (e) return e;
  }
  if (p->other) {
    e = (*v)(p->other, a); if (e) return e;
  }
  if (p->num_lookups) {
    e = (*v)(p->num_lookups, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_8ctctable_Col(PyObject *o) {
  struct __pyx_obj_8ctctable_Col *p = (struct __pyx_obj_8ctctable_Col *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->colname);
  p->colname = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->other);
  p->other = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->num_lookups);
  p->num_lookups = ((PyObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_8ctctable_3Col_num_lookups(PyObject *o, void *x) {
  return __pyx_pf_8ctctable_3Col_11num_lookups___get__(o);
}

static int __pyx_setprop_8ctctable_3Col_num_lookups(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_8ctctable_3Col_11num_lookups___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static struct PyMethodDef __pyx_methods_8ctctable_Col[] = {
  {__Pyx_NAMESTR("__invert__"), (PyCFunction)__pyx_pf_8ctctable_3Col___invert__, METH_NOARGS|METH_COEXIST, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("matches"), (PyCFunction)__pyx_pf_8ctctable_3Col_matches, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("contains"), (PyCFunction)__pyx_pf_8ctctable_3Col_contains, METH_O, __Pyx_DOCSTR(__pyx_doc_8ctctable_3Col_contains)},
  {__Pyx_NAMESTR("startswith"), (PyCFunction)__pyx_pf_8ctctable_3Col_startswith, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("endswith"), (PyCFunction)__pyx_pf_8ctctable_3Col_endswith, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("between"), (PyCFunction)__pyx_pf_8ctctable_3Col_between, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static struct PyMemberDef __pyx_members_8ctctable_Col[] = {
  {(char *)"colname", T_OBJECT, offsetof(struct __pyx_obj_8ctctable_Col, colname), 0, 0},
  {(char *)"op", T_INT, offsetof(struct __pyx_obj_8ctctable_Col, op), 0, 0},
  {(char *)"other", T_OBJECT, offsetof(struct __pyx_obj_8ctctable_Col, other), 0, 0},
  {(char *)"invert", T_INT, offsetof(struct __pyx_obj_8ctctable_Col, invert), 0, 0},
  {0, 0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_8ctctable_Col[] = {
  {(char *)"num_lookups", __pyx_getprop_8ctctable_3Col_num_lookups, __pyx_setprop_8ctctable_3Col_num_lookups, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Col = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  __pyx_pf_8ctctable_3Col___invert__, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Col = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Col = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Col = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8ctctable_Col = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("ctctable.Col"), /*tp_name*/
  sizeof(struct __pyx_obj_8ctctable_Col), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8ctctable_Col, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Col, /*tp_as_number*/
  &__pyx_tp_as_sequence_Col, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Col, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Col, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  __Pyx_DOCSTR("\n    tdb.query(Col('name') == 'Fred' & Col('age') > 22)\n        or\n    tdb.select(Q(name__in=['Fred', 'Wilma']), Q(name__contains=\"at2g\"))\n    "), /*tp_doc*/
  __pyx_tp_traverse_8ctctable_Col, /*tp_traverse*/
  __pyx_tp_clear_8ctctable_Col, /*tp_clear*/
  __pyx_pf_8ctctable_3Col___richcmp__, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8ctctable_Col, /*tp_methods*/
  __pyx_members_8ctctable_Col, /*tp_members*/
  __pyx_getsets_8ctctable_Col, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_8ctctable_3Col___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8ctctable_Col, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_8ctctable_TCQuery(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_8ctctable_TCQuery(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_8ctctable_TCQuery[] = {
  {__Pyx_NAMESTR("__del__"), (PyCFunction)__pyx_pf_8ctctable_7TCQuery___del__, METH_NOARGS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_TCQuery = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION >= 3
  0, /*reserved*/
  #else
  0, /*nb_long*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_TCQuery = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_TCQuery = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_TCQuery = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_8ctctable_TCQuery = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("ctctable.TCQuery"), /*tp_name*/
  sizeof(struct __pyx_obj_8ctctable_TCQuery), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_8ctctable_TCQuery, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_TCQuery, /*tp_as_number*/
  &__pyx_tp_as_sequence_TCQuery, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_TCQuery, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_TCQuery, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_8ctctable_TCQuery, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_8ctctable_TCQuery, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static struct PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    __Pyx_NAMESTR("ctctable"),
    __Pyx_DOCSTR(__pyx_k_12), /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_s_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 1, 0},
  {&__pyx_kp_s_10, __pyx_k_10, sizeof(__pyx_k_10), 0, 0, 1, 0},
  {&__pyx_kp_s_11, __pyx_k_11, sizeof(__pyx_k_11), 0, 0, 1, 0},
  {&__pyx_n_s_13, __pyx_k_13, sizeof(__pyx_k_13), 0, 0, 1, 1},
  {&__pyx_kp_s_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 0, 1, 0},
  {&__pyx_kp_s_15, __pyx_k_15, sizeof(__pyx_k_15), 0, 0, 1, 0},
  {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
  {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
  {&__pyx_kp_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 0},
  {&__pyx_kp_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 0},
  {&__pyx_kp_s_6, __pyx_k_6, sizeof(__pyx_k_6), 0, 0, 1, 0},
  {&__pyx_kp_s_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 0, 1, 0},
  {&__pyx_kp_s_8, __pyx_k_8, sizeof(__pyx_k_8), 0, 0, 1, 0},
  {&__pyx_kp_s_9, __pyx_k_9, sizeof(__pyx_k_9), 0, 0, 1, 0},
  {&__pyx_n_s__Exception, __pyx_k__Exception, sizeof(__pyx_k__Exception), 0, 0, 1, 1},
  {&__pyx_n_s__KeyError, __pyx_k__KeyError, sizeof(__pyx_k__KeyError), 0, 0, 1, 1},
  {&__pyx_n_s__TCException, __pyx_k__TCException, sizeof(__pyx_k__TCException), 0, 0, 1, 1},
  {&__pyx_n_s____class__, __pyx_k____class__, sizeof(__pyx_k____class__), 0, 0, 1, 1},
  {&__pyx_n_s____iter__, __pyx_k____iter__, sizeof(__pyx_k____iter__), 0, 0, 1, 1},
  {&__pyx_n_s____main__, __pyx_k____main__, sizeof(__pyx_k____main__), 0, 0, 1, 1},
  {&__pyx_n_s____name__, __pyx_k____name__, sizeof(__pyx_k____name__), 0, 0, 1, 1},
  {&__pyx_n_s____version__, __pyx_k____version__, sizeof(__pyx_k____version__), 0, 0, 1, 1},
  {&__pyx_n_s___dict_to_tcmap, __pyx_k___dict_to_tcmap, sizeof(__pyx_k___dict_to_tcmap), 0, 0, 1, 1},
  {&__pyx_n_s___key_to_dict, __pyx_k___key_to_dict, sizeof(__pyx_k___key_to_dict), 0, 0, 1, 1},
  {&__pyx_n_s___msg, __pyx_k___msg, sizeof(__pyx_k___msg), 0, 0, 1, 1},
  {&__pyx_n_s___set_limit, __pyx_k___set_limit, sizeof(__pyx_k___set_limit), 0, 0, 1, 1},
  {&__pyx_n_s___set_order, __pyx_k___set_order, sizeof(__pyx_k___set_order), 0, 0, 1, 1},
  {&__pyx_n_s___state, __pyx_k___state, sizeof(__pyx_k___state), 0, 0, 1, 1},
  {&__pyx_n_s___tclist_to_list, __pyx_k___tclist_to_list, sizeof(__pyx_k___tclist_to_list), 0, 0, 1, 1},
  {&__pyx_n_s___tcmap_to_dict, __pyx_k___tcmap_to_dict, sizeof(__pyx_k___tcmap_to_dict), 0, 0, 1, 1},
  {&__pyx_n_s___throw, __pyx_k___throw, sizeof(__pyx_k___throw), 0, 0, 1, 1},
  {&__pyx_n_s__basestring, __pyx_k__basestring, sizeof(__pyx_k__basestring), 0, 0, 1, 1},
  {&__pyx_n_s__capitalize, __pyx_k__capitalize, sizeof(__pyx_k__capitalize), 0, 0, 1, 1},
  {&__pyx_n_s__colname, __pyx_k__colname, sizeof(__pyx_k__colname), 0, 0, 1, 1},
  {&__pyx_n_s__count, __pyx_k__count, sizeof(__pyx_k__count), 0, 0, 1, 1},
  {&__pyx_n_s__d, __pyx_k__d, sizeof(__pyx_k__d), 0, 0, 1, 1},
  {&__pyx_n_s__default, __pyx_k__default, sizeof(__pyx_k__default), 0, 0, 1, 1},
  {&__pyx_n_s__delete, __pyx_k__delete, sizeof(__pyx_k__delete), 0, 0, 1, 1},
  {&__pyx_n_s__dic, __pyx_k__dic, sizeof(__pyx_k__dic), 0, 0, 1, 1},
  {&__pyx_n_s__format, __pyx_k__format, sizeof(__pyx_k__format), 0, 0, 1, 1},
  {&__pyx_n_s__get, __pyx_k__get, sizeof(__pyx_k__get), 0, 0, 1, 1},
  {&__pyx_n_s__high, __pyx_k__high, sizeof(__pyx_k__high), 0, 0, 1, 1},
  {&__pyx_n_s__id, __pyx_k__id, sizeof(__pyx_k__id), 0, 0, 1, 1},
  {&__pyx_n_s__invert, __pyx_k__invert, sizeof(__pyx_k__invert), 0, 0, 1, 1},
  {&__pyx_n_s__is_open, __pyx_k__is_open, sizeof(__pyx_k__is_open), 0, 0, 1, 1},
  {&__pyx_n_s__items, __pyx_k__items, sizeof(__pyx_k__items), 0, 0, 1, 1},
  {&__pyx_n_s__join, __pyx_k__join, sizeof(__pyx_k__join), 0, 0, 1, 1},
  {&__pyx_n_s__k, __pyx_k__k, sizeof(__pyx_k__k), 0, 0, 1, 1},
  {&__pyx_n_s__keep, __pyx_k__keep, sizeof(__pyx_k__keep), 0, 0, 1, 1},
  {&__pyx_n_s__keep_or_put, __pyx_k__keep_or_put, sizeof(__pyx_k__keep_or_put), 0, 0, 1, 1},
  {&__pyx_n_s__limit, __pyx_k__limit, sizeof(__pyx_k__limit), 0, 0, 1, 1},
  {&__pyx_n_s__low, __pyx_k__low, sizeof(__pyx_k__low), 0, 0, 1, 1},
  {&__pyx_n_s__map, __pyx_k__map, sizeof(__pyx_k__map), 0, 0, 1, 1},
  {&__pyx_n_s__message, __pyx_k__message, sizeof(__pyx_k__message), 0, 0, 1, 1},
  {&__pyx_n_s__mode, __pyx_k__mode, sizeof(__pyx_k__mode), 0, 0, 1, 1},
  {&__pyx_n_s__num_lookups, __pyx_k__num_lookups, sizeof(__pyx_k__num_lookups), 0, 0, 1, 1},
  {&__pyx_n_s__offset, __pyx_k__offset, sizeof(__pyx_k__offset), 0, 0, 1, 1},
  {&__pyx_n_s__op, __pyx_k__op, sizeof(__pyx_k__op), 0, 0, 1, 1},
  {&__pyx_n_s__order, __pyx_k__order, sizeof(__pyx_k__order), 0, 0, 1, 1},
  {&__pyx_n_s__other, __pyx_k__other, sizeof(__pyx_k__other), 0, 0, 1, 1},
  {&__pyx_n_s__path, __pyx_k__path, sizeof(__pyx_k__path), 0, 0, 1, 1},
  {&__pyx_n_s__pop, __pyx_k__pop, sizeof(__pyx_k__pop), 0, 0, 1, 1},
  {&__pyx_n_s__put, __pyx_k__put, sizeof(__pyx_k__put), 0, 0, 1, 1},
  {&__pyx_n_s__r, __pyx_k__r, sizeof(__pyx_k__r), 0, 0, 1, 1},
  {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
  {&__pyx_n_s__reading, __pyx_k__reading, sizeof(__pyx_k__reading), 0, 0, 1, 1},
  {&__pyx_n_s__select, __pyx_k__select, sizeof(__pyx_k__select), 0, 0, 1, 1},
  {&__pyx_n_s__size_of, __pyx_k__size_of, sizeof(__pyx_k__size_of), 0, 0, 1, 1},
  {&__pyx_n_s__w, __pyx_k__w, sizeof(__pyx_k__w), 0, 0, 1, 1},
  {&__pyx_n_s__writing, __pyx_k__writing, sizeof(__pyx_k__writing), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_n_s__Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_KeyError = __Pyx_GetName(__pyx_b, __pyx_n_s__KeyError); if (!__pyx_builtin_KeyError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_basestring = __Pyx_GetName(__pyx_b, __pyx_n_s__basestring); if (!__pyx_builtin_basestring) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_map = __Pyx_GetName(__pyx_b, __pyx_n_s__map); if (!__pyx_builtin_map) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_5 = PyInt_FromLong(5); if (unlikely(!__pyx_int_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initctctable(void); /*proto*/
PyMODINIT_FUNC initctctable(void)
#else
PyMODINIT_FUNC PyInit_ctctable(void); /*proto*/
PyMODINIT_FUNC PyInit_ctctable(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  #if CYTHON_REFNANNY
  void* __pyx_refnanny = NULL;
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  __pyx_refnanny = __Pyx_RefNanny->SetupContext("PyMODINIT_FUNC PyInit_ctctable(void)", __LINE__, __FILE__);
  #endif
  __pyx_init_filenames();
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION < 3
  __pyx_empty_bytes = PyString_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #else
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4(__Pyx_NAMESTR("ctctable"), __pyx_methods, __Pyx_DOCSTR(__pyx_k_12), 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_NAMESTR(__Pyx_BUILTIN_MODULE_NAME));
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_module_is_main_ctctable) {
    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_n_s____main__) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Global init code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  __pyx_vtabptr_8ctctable_TCTable = &__pyx_vtable_8ctctable_TCTable;
  #if PY_MAJOR_VERSION >= 3
  __pyx_vtable_8ctctable_TCTable._dict_to_tcmap = (TCMAP *(*)(struct __pyx_obj_8ctctable_TCTable *, PyObject *))__pyx_f_8ctctable_7TCTable__dict_to_tcmap;
  __pyx_vtable_8ctctable_TCTable._tcmap_to_dict = (PyObject *(*)(struct __pyx_obj_8ctctable_TCTable *, TCMAP *))__pyx_f_8ctctable_7TCTable__tcmap_to_dict;
  __pyx_vtable_8ctctable_TCTable.size_of = (int (*)(struct __pyx_obj_8ctctable_TCTable *, PyObject *, int __pyx_skip_dispatch))__pyx_f_8ctctable_7TCTable_size_of;
  __pyx_vtable_8ctctable_TCTable._set_limit = (void (*)(struct __pyx_obj_8ctctable_TCTable *, TDBQRY *, PyObject *))__pyx_f_8ctctable_7TCTable__set_limit;
  __pyx_vtable_8ctctable_TCTable._set_order = (void (*)(struct __pyx_obj_8ctctable_TCTable *, TDBQRY *, PyObject *))__pyx_f_8ctctable_7TCTable__set_order;
  __pyx_vtable_8ctctable_TCTable._tclist_to_list = (PyObject *(*)(struct __pyx_obj_8ctctable_TCTable *, TCLIST *, int))__pyx_f_8ctctable_7TCTable__tclist_to_list;
  #else
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable._dict_to_tcmap = (void(*)(void))__pyx_f_8ctctable_7TCTable__dict_to_tcmap;
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable._tcmap_to_dict = (void(*)(void))__pyx_f_8ctctable_7TCTable__tcmap_to_dict;
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable.size_of = (void(*)(void))__pyx_f_8ctctable_7TCTable_size_of;
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable._set_limit = (void(*)(void))__pyx_f_8ctctable_7TCTable__set_limit;
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable._set_order = (void(*)(void))__pyx_f_8ctctable_7TCTable__set_order;
  *(void(**)(void))&__pyx_vtable_8ctctable_TCTable._tclist_to_list = (void(*)(void))__pyx_f_8ctctable_7TCTable__tclist_to_list;
  #endif
  if (PyType_Ready(&__pyx_type_8ctctable_TCTable) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetVtable(__pyx_type_8ctctable_TCTable.tp_dict, __pyx_vtabptr_8ctctable_TCTable) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "TCTable", (PyObject *)&__pyx_type_8ctctable_TCTable) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8ctctable_TCTable = &__pyx_type_8ctctable_TCTable;
  if (PyType_Ready(&__pyx_type_8ctctable_Col) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Col", (PyObject *)&__pyx_type_8ctctable_Col) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8ctctable_Col = &__pyx_type_8ctctable_Col;
  if (PyType_Ready(&__pyx_type_8ctctable_TCQuery) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "TCQuery", (PyObject *)&__pyx_type_8ctctable_TCQuery) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_8ctctable_TCQuery = &__pyx_type_8ctctable_TCQuery;
  /*--- Type import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "/usr/local/src/tctable/src/ctctable.pyx":20
 * cimport python_string as ps
 * 
 * tokyo_cabinet_version = c_tcversion             # <<<<<<<<<<<<<<
 * __version__ = '0.1'
 * 
 */
  __pyx_t_1 = __Pyx_PyBytes_FromString(tcversion); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_13, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "/usr/local/src/tctable/src/ctctable.pyx":21
 * 
 * tokyo_cabinet_version = c_tcversion
 * __version__ = '0.1'             # <<<<<<<<<<<<<<
 * 
 * class TCException(Exception):
 */
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s____version__, ((PyObject *)__pyx_kp_s_14)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 21; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/usr/local/src/tctable/src/ctctable.pyx":23
 * __version__ = '0.1'
 * 
 * class TCException(Exception):             # <<<<<<<<<<<<<<
 *     '''An error communicating with the Tokyo Cabinet database.'''
 * 
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_builtin_Exception);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_builtin_Exception);
  __Pyx_GIVEREF(__pyx_builtin_Exception);
  if (PyDict_SetItemString(((PyObject *)__pyx_t_1), "__doc__", ((PyObject *)__pyx_kp_s_15)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = __Pyx_CreateClass(__pyx_t_2, ((PyObject *)__pyx_t_1), __pyx_n_s__TCException, "ctctable"); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__TCException, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;

  /* "/usr/local/lib/python2.6/dist-packages/Cython/Includes/python_string.pxd":1
 * from python_ref cimport PyObject             # <<<<<<<<<<<<<<
 * 
 * cdef extern from "Python.h":
 */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  if (__pyx_m) {
    __Pyx_AddTraceback("init ctctable");
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init ctctable");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

static const char *__pyx_filenames[] = {
  "ctctable.pyx",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AS_STRING(kw_name));
        #endif
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *number, *more_or_less;

    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    number = (num_expected == 1) ? "" : "s";
    PyErr_Format(PyExc_TypeError,
        #if PY_VERSION_HEX < 0x02050000
            "%s() takes %s %d positional argument%s (%d given)",
        #else
            "%s() takes %s %zd positional argument%s (%zd given)",
        #endif
        func_name, more_or_less, num_expected, number, num_found);
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;

    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
        } else {
            #if PY_MAJOR_VERSION < 3
            if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key))) {
            #else
            if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key))) {
            #endif
                goto invalid_keyword_type;
            } else {
                for (name = first_kw_arg; *name; name++) {
                    #if PY_MAJOR_VERSION >= 3
                    if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                        PyUnicode_Compare(**name, key) == 0) break;
                    #else
                    if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                        _PyString_Eq(**name, key)) break;
                    #endif
                }
                if (*name) {
                    values[name-argnames] = value;
                } else {
                    /* unexpected keyword found */
                    for (name=argnames; name != first_kw_arg; name++) {
                        if (**name == key) goto arg_passed_twice;
                        #if PY_MAJOR_VERSION >= 3
                        if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                            PyUnicode_Compare(**name, key) == 0) goto arg_passed_twice;
                        #else
                        if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                            _PyString_Eq(**name, key)) goto arg_passed_twice;
                        #endif
                    }
                    if (kwds2) {
                        if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                    } else {
                        goto invalid_keyword;
                    }
                }
            }
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, **name);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
        #if PY_VERSION_HEX < 0x02050000
                 "need more than %d value%s to unpack", (int)index,
        #else
                 "need more than %zd value%s to unpack", index,
        #endif
                 (index == 1) ? "" : "s");
}

static INLINE void __Pyx_RaiseTooManyValuesError(void) {
    PyErr_SetString(PyExc_ValueError, "too many values to unpack");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter, Py_ssize_t index) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred()) {
            __Pyx_RaiseNeedMoreValuesError(index);
        }
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_RaiseTooManyValuesError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *local_type, *local_value, *local_tb;
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    local_type = tstate->curexc_type;
    local_value = tstate->curexc_value;
    local_tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
    if (unlikely(tstate->curexc_type))
        goto bad;
    #if PY_MAJOR_VERSION >= 3
    if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
        goto bad;
    #endif
    *type = local_type;
    *value = local_value;
    *tb = local_tb;
    Py_INCREF(local_type);
    Py_INCREF(local_value);
    Py_INCREF(local_tb);
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = local_type;
    tstate->exc_value = local_value;
    tstate->exc_traceback = local_tb;
    /* Make sure tstate is in a consistent state when we XDECREF
       these objects (XDECREF may run arbitrary code). */
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
    return 0;
bad:
    *type = 0;
    *value = 0;
    *tb = 0;
    Py_XDECREF(local_type);
    Py_XDECREF(local_value);
    Py_XDECREF(local_tb);
    return -1;
}


static INLINE void __Pyx_RaiseNoneNotIterableError(void) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
}


static INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key)))
        #endif
            goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    return 0;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

static INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
}

static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static PyObject *__Pyx_CreateClass(
    PyObject *bases, PyObject *dict, PyObject *name, const char *modname)
{
    PyObject *py_modname;
    PyObject *result = 0;

    #if PY_MAJOR_VERSION < 3
    py_modname = PyString_FromString(modname);
    #else
    py_modname = PyUnicode_FromString(modname);
    #endif
    if (!py_modname)
        goto bad;
    if (PyDict_SetItemString(dict, "__module__", py_modname) < 0)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    result = PyClass_New(bases, dict, name);
    #else
    result = PyObject_CallFunctionObjArgs((PyObject *)&PyType_Type, name, bases, dict, NULL);
    #endif
bad:
    Py_XDECREF(py_modname);
    return result;
}

static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();

    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;

    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}


#if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                type = 0;
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) Py_TYPE(type);
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }

    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

#else /* Python 3+ */

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;

    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (!PyExceptionClass_Check(type)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }

    PyErr_SetObject(type, value);

    if (tb) {
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
    }

bad:
    return;
}
#endif

static INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject* x) {
    const unsigned char neg_one = (unsigned char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned char" :
                    "value too large to convert to unsigned char");
            }
            return (unsigned char)-1;
        }
        return (unsigned char)val;
    }
    return (unsigned char)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject* x) {
    const unsigned short neg_one = (unsigned short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned short" :
                    "value too large to convert to unsigned short");
            }
            return (unsigned short)-1;
        }
        return (unsigned short)val;
    }
    return (unsigned short)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject* x) {
    const unsigned int neg_one = (unsigned int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned int" :
                    "value too large to convert to unsigned int");
            }
            return (unsigned int)-1;
        }
        return (unsigned int)val;
    }
    return (unsigned int)__Pyx_PyInt_AsUnsignedLong(x);
}

static INLINE char __Pyx_PyInt_AsChar(PyObject* x) {
    const char neg_one = (char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to char" :
                    "value too large to convert to char");
            }
            return (char)-1;
        }
        return (char)val;
    }
    return (char)__Pyx_PyInt_AsLong(x);
}

static INLINE short __Pyx_PyInt_AsShort(PyObject* x) {
    const short neg_one = (short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to short" :
                    "value too large to convert to short");
            }
            return (short)-1;
        }
        return (short)val;
    }
    return (short)__Pyx_PyInt_AsLong(x);
}

static INLINE int __Pyx_PyInt_AsInt(PyObject* x) {
    const int neg_one = (int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to int" :
                    "value too large to convert to int");
            }
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject* x) {
    const signed char neg_one = (signed char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed char" :
                    "value too large to convert to signed char");
            }
            return (signed char)-1;
        }
        return (signed char)val;
    }
    return (signed char)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject* x) {
    const signed short neg_one = (signed short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed short" :
                    "value too large to convert to signed short");
            }
            return (signed short)-1;
        }
        return (signed short)val;
    }
    return (signed short)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject* x) {
    const signed int neg_one = (signed int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed int" :
                    "value too large to convert to signed int");
            }
            return (signed int)-1;
        }
        return (signed int)val;
    }
    return (signed int)__Pyx_PyInt_AsSignedLong(x);
}

static INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject* x) {
    const unsigned long neg_one = (unsigned long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned long");
            return (unsigned long)-1;
        }
        return (unsigned long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned long");
                return (unsigned long)-1;
            }
            return PyLong_AsUnsignedLong(x);
        } else {
            return PyLong_AsLong(x);
        }
    } else {
        unsigned long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned long)-1;
        val = __Pyx_PyInt_AsUnsignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    const unsigned PY_LONG_LONG neg_one = (unsigned PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned PY_LONG_LONG");
            return (unsigned PY_LONG_LONG)-1;
        }
        return (unsigned PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned PY_LONG_LONG");
                return (unsigned PY_LONG_LONG)-1;
            }
            return PyLong_AsUnsignedLongLong(x);
        } else {
            return PyLong_AsLongLong(x);
        }
    } else {
        unsigned PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE long __Pyx_PyInt_AsLong(PyObject* x) {
    const long neg_one = (long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to long");
            return (long)-1;
        }
        return (long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to long");
                return (long)-1;
            }
            return PyLong_AsUnsignedLong(x);
        } else {
            return PyLong_AsLong(x);
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long)-1;
        val = __Pyx_PyInt_AsLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject* x) {
    const PY_LONG_LONG neg_one = (PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to PY_LONG_LONG");
            return (PY_LONG_LONG)-1;
        }
        return (PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to PY_LONG_LONG");
                return (PY_LONG_LONG)-1;
            }
            return PyLong_AsUnsignedLongLong(x);
        } else {
            return PyLong_AsLongLong(x);
        }
    } else {
        PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject* x) {
    const signed long neg_one = (signed long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed long");
            return (signed long)-1;
        }
        return (signed long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed long");
                return (signed long)-1;
            }
            return PyLong_AsUnsignedLong(x);
        } else {
            return PyLong_AsLong(x);
        }
    } else {
        signed long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed long)-1;
        val = __Pyx_PyInt_AsSignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject* x) {
    const signed PY_LONG_LONG neg_one = (signed PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed PY_LONG_LONG");
            return (signed PY_LONG_LONG)-1;
        }
        return (signed PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed PY_LONG_LONG");
                return (signed PY_LONG_LONG)-1;
            }
            return PyLong_AsUnsignedLongLong(x);
        } else {
            return PyLong_AsLongLong(x);
        }
    } else {
        signed PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsSignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static void __Pyx_WriteUnraisable(const char *name) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
    #if PY_MAJOR_VERSION < 3
    ctx = PyString_FromString(name);
    #else
    ctx = PyUnicode_FromString(name);
    #endif
    __Pyx_ErrRestore(old_exc, old_val, old_tb);
    if (!ctx) {
        PyErr_WriteUnraisable(Py_None);
    } else {
        PyErr_WriteUnraisable(ctx);
        Py_DECREF(ctx);
    }
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
#if PY_VERSION_HEX < 0x03010000
    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
#else
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
#endif
    if (!ob)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", ob) < 0)
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

/* Type Conversion Functions */

static INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   if (x == Py_True) return 1;
   else if ((x == Py_False) | (x == Py_None)) return 0;
   else return PyObject_IsTrue(x);
}

static INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_VERSION_HEX < 0x03000000
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_VERSION_HEX < 0x03000000
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_VERSION_HEX < 0x03000000
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%s__ returned non-%s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}

static INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
#if PY_VERSION_HEX < 0x02050000
   if (ival <= LONG_MAX)
       return PyInt_FromLong((long)ival);
   else {
       unsigned char *bytes = (unsigned char *) &ival;
       int one = 1; int little = (int)*(unsigned char*)&one;
       return _PyLong_FromByteArray(bytes, sizeof(size_t), little, 0);
   }
#else
   return PyInt_FromSize_t(ival);
#endif
}

static INLINE size_t __Pyx_PyInt_AsSize_t(PyObject* x) {
   unsigned PY_LONG_LONG val = __Pyx_PyInt_AsUnsignedLongLong(x);
   if (unlikely(val == (unsigned PY_LONG_LONG)-1 && PyErr_Occurred())) {
       return (size_t)-1;
   } else if (unlikely(val != (unsigned PY_LONG_LONG)(size_t)val)) {
       PyErr_SetString(PyExc_OverflowError,
                       "value too large to convert to size_t");
       return (size_t)-1;
   }
   return (size_t)val;
}


#endif /* Py_PYTHON_H */
